<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Minlong Xie" />

<meta name="date" content="2024-12-08" />

<title>All homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">All homework</h1>
<h4 class="author">Minlong Xie</h4>
<h4 class="date">2024-12-08</h4>



<p><strong>HW0</strong></p>
<p>Use knitr to produce at least 3 examples. For each example, texts
should mix with figures and/or tables. Better to have mathematical
formulas</p>
<div id="正态分布" class="section level1">
<h1>1、正态分布</h1>
<p>我们生成一个均值为0，标准差为1的标准正态分布： <span class="math display">\[
X ∼ N(0,1)
\]</span> <strong>R代码</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">hist</span>(data, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">&quot;正态分布直方图&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;值&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;频数&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从图中可以看出，正态分布的数据大致呈钟形分布。</p>
</div>
<div id="比较两组数据的描述性统计量" class="section level1">
<h1>2、比较两组数据的描述性统计量</h1>
<p>我们比较两组数据的均值、标准差、中位数、最小值、最大值，这两组数据分别来自于：
<span class="math display">\[
X∼N(5,2)\\
Y∼N(10,3)
\]</span> <strong>R代码</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1213</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>group_a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>group_b <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>data_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">Group =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">mean</span>(group_a), <span class="fu">mean</span>(group_b)),</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="at">SD =</span> <span class="fu">c</span>(<span class="fu">sd</span>(group_a), <span class="fu">sd</span>(group_b)),</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="at">Median =</span> <span class="fu">c</span>(<span class="fu">median</span>(group_a), <span class="fu">median</span>(group_b)),</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="at">Min =</span> <span class="fu">c</span>(<span class="fu">min</span>(group_a), <span class="fu">min</span>(group_b)),</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="at">Max =</span> <span class="fu">c</span>(<span class="fu">max</span>(group_a), <span class="fu">max</span>(group_b))</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(data_summary, <span class="at">caption =</span> <span class="st">&quot;组A和组B的描述性统计量&quot;</span>)</span></code></pre></div>
<table>
<caption>组A和组B的描述性统计量</caption>
<thead>
<tr class="header">
<th align="left">Group</th>
<th align="right">Mean</th>
<th align="right">SD</th>
<th align="right">Median</th>
<th align="right">Min</th>
<th align="right">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">4.905735</td>
<td align="right">2.195442</td>
<td align="right">5.343371</td>
<td align="right">0.0056975</td>
<td align="right">8.32746</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">10.234197</td>
<td align="right">3.024161</td>
<td align="right">10.445277</td>
<td align="right">4.5193372</td>
<td align="right">19.67812</td>
</tr>
</tbody>
</table>
<p>从上表可以看出，两组数据的描述性统计量各不相同，其中样本均值和样本方差都与各自的总体均值和总体方差较为接近。</p>
</div>
<div id="回归分析" class="section level1">
<h1>3、回归分析</h1>
<p>我们使用线性回归模型来分析变量<span class="math inline">\(x\)</span>和<span class="math inline">\(y\)</span>之间的关系。假设关系为： <span class="math display">\[
y=\beta_0+\beta_1x+ϵ
\]</span> 其中<span class="math inline">\(ϵ\)</span>为随机误差，假设服从正态分布。</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">main =</span> <span class="st">&quot;散点图与回归直线&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">abline</span>(model, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.9073 -0.6835 -0.0875  0.5806  3.2904 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.02838    0.29338   6.914 4.84e-10 ***
## x            1.47376    0.05344  27.578  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9707 on 98 degrees of freedom
## Multiple R-squared:  0.8859, Adjusted R-squared:  0.8847 
## F-statistic: 760.6 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>从<span class="math inline">\(x\)</span>和<span class="math inline">\(y\)</span>的散点图可以看出，它们的关系大致为线性关系，我们进行线性回归分析，得到的回归结果为：
<span class="math display">\[
\hat{y}=2.028+1.474x
\]</span> 即<span class="math inline">\(\hat{\beta_0}=2.028,\hat{\beta_1}=1.474\)</span>。线性回归模型的<span class="math inline">\(R^2=0.8859\)</span>，且系数都通过了显著性检验。</p>
<p><strong>HW1</strong></p>
<p><strong>3.4</strong> The Rayleigh density [156, Ch. 18] is <span class="math display">\[
f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},~~~x\geq 0,~\sigma&gt;0.
\]</span></p>
<p>Develop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(σ\)</span>) distribution. Generate Rayleigh(<span class="math inline">\(σ\)</span>) samples for several choices of <span class="math inline">\(σ&gt;0\)</span> and check that the mode of the
generated samples is close to the theoretical mode <span class="math inline">\(σ\)</span> (check the histogram).</p>
<p><strong>解题思路</strong></p>
<p>(1)首先计算Rayleigh(<span class="math inline">\(σ\)</span>)的分布函数，为： <span class="math display">\[
F(x)=1-e^{-x^2/(2\sigma^2)}
\]</span></p>
<p>(2)利用反函数变换方法生成Rayleigh(<span class="math inline">\(σ\)</span>)分布的随机数： <span class="math display">\[
X=\sigma\sqrt{-2\ln (1-U)}
\]</span> 其中<span class="math inline">\(U\sim U(0,1)\)</span>。</p>
<p>(3)绘制频率分布直方图并与真实的Rayleigh(<span class="math inline">\(σ\)</span>)分布进行比较</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)   <span class="co">#设置随机种子</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co"># Rayleigh分布随机数生成函数</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>generate_rayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma) {</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)  <span class="co"># 生成n个(0,1)之间的均匀分布随机数</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u))</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co"># 设置不同的sigma值</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>sigma_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">length</span>(sigma_values)))  <span class="co"># 设置多图排列</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co"># 对每个sigma值生成样本并绘制直方图</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="cf">for</span> (sigma <span class="cf">in</span> sigma_values) {</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">generate_rayleigh</span>(<span class="dv">1000</span>, sigma)</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>  </span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>  <span class="co"># 绘制样本的直方图，并标出理论峰值sigma</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>  <span class="fu">hist</span>(samples, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Rayleigh分布 (σ =&quot;</span>, sigma, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;值&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;频率/组距&quot;</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> sigma, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)  <span class="co"># 理论峰值</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>  </span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>  <span class="co"># 叠加真实的Rayleigh分布密度函数</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>  <span class="fu">curve</span>((x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)), </span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>        <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="fu">max</span>(samples), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># 恢复图形布局</span></span></code></pre></div>
<p>从以上三个频率分布直方图可以看出，反函数变换法生成的 Rayleigh(<span class="math inline">\(σ\)</span>) 分布与真实的Rayleigh(<span class="math inline">\(σ\)</span>)分布接近。</p>
<p><strong>3.11</strong> Generate a random sample of size 1000 from a
normal location mixture. The components of the mixture have <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distributions with mixing
probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 =1− p_1\)</span>. Graph the histogram of the
sample with density superimposed, for <span class="math inline">\(p_1
=0.75\)</span>. Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical
distribution of the mixture appears to be bimodal. Make a conjecture
about the values of <span class="math inline">\(p_1\)</span> that
produce bimodal mixtures.</p>
<p><strong>解题思路</strong></p>
<p>(1)设置不同的<span class="math inline">\(p_1\)</span>值(0.25, 0.4,
0.5, 0.6, 0.75)生成正态分布的混合分布</p>
<p>(2)绘制混合分布的频率分布直方图</p>
<p>(3)观察直方图的形状是否有双峰</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)   <span class="co">#设置随机种子</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># 正态混合分布样本生成函数</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>generate_mixture <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p1) {</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="co"># 生成1000个0和1的样本，以概率p1生成0，其余生成1</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  component <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p1)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="co"># 根据component选择分布N(0,1)或N(3,1)</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(component <span class="sc">==</span> <span class="dv">0</span>, <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  <span class="fu">return</span>(sample)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>}</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co"># 设置初始的p1值</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>p1_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.75</span>)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">length</span>(p1_values)))  <span class="co"># 设置多图排列</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co"># 对不同的p1值生成样本并绘制直方图</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="cf">for</span> (p1 <span class="cf">in</span> p1_values) {</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">generate_mixture</span>(<span class="dv">1000</span>, p1)</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>  </span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>  <span class="co"># 绘制样本直方图</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>  <span class="fu">hist</span>(samples, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>, </span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Normal Mixture (p1 =&quot;</span>, p1, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;值&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;频率/组距&quot;</span>)</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>  </span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># 恢复图形布局</span></span></code></pre></div>
<p>从以上频率分布直方图的形状可以看出，<span class="math inline">\(p_1\)</span>的值越接近0.5，分布的形状越接近双峰，因此猜测产生双峰的最合适<span class="math inline">\(p_1\)</span>值为0.5。</p>
<p><strong>3.20</strong> A compound Poisson process is a stochastic
process <span class="math inline">\({X(t),t≥ 0}\)</span> that can be
represented as the random sum <span class="math inline">\(X(t)=\sum\limits _{i=1}^{N(t)} Y_i, t≥ 0\)</span>,
where <span class="math inline">\({N(t),t≥ 0}\)</span> is a Poisson
process and <span class="math inline">\(Y_1,Y_2\)</span>,… are iid and
independent of <span class="math inline">\({N(t),t≥ 0}\)</span>. Write a
program to simulate a compound Poisson(<span class="math inline">\(λ\)</span>)–Gamma process (<span class="math inline">\(Y\)</span> has a Gamma distribution). Estimate the
mean and the variance of <span class="math inline">\(X(10)\)</span> for
several choices of the parameters and compare with the theoretical
values. Hint: Show that <span class="math inline">\(E[X(t)] =
λtE[Y1]\)</span> and <span class="math inline">\(Var(X(t)) =
λtE[Y^2_1]\)</span>.</p>
<p><strong>解题思路</strong></p>
<p>(1)首先证明复合泊松过程的均值和方差公式： <span class="math display">\[
\begin{align}
E[X(t)]
&amp;=E(E(\sum\limits _{i=1}^{N(t)} Y_i|N(t)))\\
&amp;=\sum\limits^{\infty}_{n=0}E(\sum\limits _{i=1}^{N(t)}
Y_i|N(t)=n)P(N(t)=n)\\
&amp;=\sum\limits^{\infty}_{n=0}E(\sum\limits _{i=1}^{n}
Y_i|N(t)=n)P(N(t)=n)\\
&amp;=\sum\limits^{\infty}_{n=0}nEY_1P(N(t)=n)\\
&amp;=EY_1\sum\limits^{\infty}_{n=0}nP(N(t)=n)\\
&amp;=\lambda t EY_1
\end{align}
\]</span> <span class="math display">\[
\begin{align}
E[X(t)]^2
&amp;=E(E((\sum\limits _{i=1}^{N(t)} Y_i)^2|N(t)))\\
&amp;=\sum\limits^{\infty}_{n=0}E((\sum\limits _{i=1}^{N(t)}
Y_i)^2|N(t)=n)P(N(t)=n)\\
&amp;=\sum\limits^{\infty}_{n=0}E((\sum\limits _{i=1}^{n}
Y_i)^2|N(t)=n)P(N(t)=n)\\
&amp;=\sum\limits^{\infty}_{n=0}(Var(\sum\limits _{i=1}^{n}
Y_i)+(E\sum\limits _{i=1}^{n} Y_i)^2)P(N(t)=n)\\
&amp;=(EY_1)^2\sum\limits^{\infty}_{n=0}n^2P(N(t)=n)+Var(Y_1)\sum\limits^{\infty}_{n=0}nP(N(t)=n)\\
&amp;=(\lambda^2 t^2+\lambda t)(EY_1)^2+\lambda t Var(Y_1)
\end{align}
\]</span> 从而 <span class="math display">\[
Var(X(t))=E[X(t)]^2-(E[X(t)])^2=\lambda t(EY_1)^2+\lambda t
Var(Y_1)=\lambda tEY_1^2
\]</span> (2)设置几组参数并模拟复合泊松-伽马过程</p>
<p>(3)对均值和方差的估计值与理论值进行比较</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1213</span>)  <span class="co"># 设置随机种子</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co"># 复合泊松-伽马过程模拟函数</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>simulate_compound_poisson_gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, alpha, beta, t, num_simulations) {</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_simulations)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  </span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_simulations) {</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>    <span class="co"># 生成泊松过程的事件数量</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>    N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> t)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>    </span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>    <span class="co"># 如果N_t &gt; 0，则生成N_t个Gamma(alpha, beta)随机变量并求和</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>    <span class="cf">if</span> (N_t <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>      Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t, <span class="at">shape =</span> alpha, <span class="at">scale =</span> beta)</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>      results[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>      results[i] <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># 如果N_t = 0，则X(t) = 0</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>    }</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>  }</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>  </span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>}</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>parameter_sets <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">lambda =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="dv">3</span>, <span class="at">beta =</span> <span class="fl">1.5</span>),</span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">lambda =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="dv">2</span>, <span class="at">beta =</span> <span class="fl">2.0</span>),</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">lambda =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="dv">4</span>, <span class="at">beta =</span> <span class="fl">0.8</span>)</span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>)</span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a><span class="co"># 模拟参数</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>num_simulations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a><span class="co"># 对每一组参数进行模拟和理论计算</span></span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a><span class="cf">for</span> (params <span class="cf">in</span> parameter_sets) {</span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> params<span class="sc">$</span>lambda</span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> params<span class="sc">$</span>alpha</span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> params<span class="sc">$</span>beta</span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a>  </span>
<span id="cb10-41"><a href="#cb10-41" tabindex="-1"></a>  <span class="co"># 模拟复合泊松过程</span></span>
<span id="cb10-42"><a href="#cb10-42" tabindex="-1"></a>  simulated_values <span class="ot">&lt;-</span> <span class="fu">simulate_compound_poisson_gamma</span>(lambda, alpha, beta, t, num_simulations)</span>
<span id="cb10-43"><a href="#cb10-43" tabindex="-1"></a>  </span>
<span id="cb10-44"><a href="#cb10-44" tabindex="-1"></a>  <span class="co"># 计算模拟均值和方差</span></span>
<span id="cb10-45"><a href="#cb10-45" tabindex="-1"></a>  simulated_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(simulated_values)</span>
<span id="cb10-46"><a href="#cb10-46" tabindex="-1"></a>  simulated_variance <span class="ot">&lt;-</span> <span class="fu">var</span>(simulated_values)</span>
<span id="cb10-47"><a href="#cb10-47" tabindex="-1"></a>  </span>
<span id="cb10-48"><a href="#cb10-48" tabindex="-1"></a>  <span class="co"># 计算理论均值和方差</span></span>
<span id="cb10-49"><a href="#cb10-49" tabindex="-1"></a>  theoretical_mean <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> alpha <span class="sc">*</span> beta</span>
<span id="cb10-50"><a href="#cb10-50" tabindex="-1"></a>  theoretical_variance <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> (alpha <span class="sc">*</span> beta<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (alpha <span class="sc">*</span> beta)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb10-51"><a href="#cb10-51" tabindex="-1"></a>  </span>
<span id="cb10-52"><a href="#cb10-52" tabindex="-1"></a>  <span class="co"># 将结果添加到数据框</span></span>
<span id="cb10-53"><a href="#cb10-53" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb10-54"><a href="#cb10-54" tabindex="-1"></a>    <span class="at">Lambda =</span> lambda,</span>
<span id="cb10-55"><a href="#cb10-55" tabindex="-1"></a>    <span class="at">Alpha =</span> alpha,</span>
<span id="cb10-56"><a href="#cb10-56" tabindex="-1"></a>    <span class="at">Beta =</span> beta,</span>
<span id="cb10-57"><a href="#cb10-57" tabindex="-1"></a>    <span class="at">Simulated_Mean =</span> simulated_mean,</span>
<span id="cb10-58"><a href="#cb10-58" tabindex="-1"></a>    <span class="at">Theoretical_Mean =</span> theoretical_mean,</span>
<span id="cb10-59"><a href="#cb10-59" tabindex="-1"></a>    <span class="at">Simulated_Variance =</span> simulated_variance,</span>
<span id="cb10-60"><a href="#cb10-60" tabindex="-1"></a>    <span class="at">Theoretical_Variance =</span> theoretical_variance</span>
<span id="cb10-61"><a href="#cb10-61" tabindex="-1"></a>  ))</span>
<span id="cb10-62"><a href="#cb10-62" tabindex="-1"></a>}</span>
<span id="cb10-63"><a href="#cb10-63" tabindex="-1"></a></span>
<span id="cb10-64"><a href="#cb10-64" tabindex="-1"></a><span class="co"># 打印结果表格</span></span>
<span id="cb10-65"><a href="#cb10-65" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##   Lambda Alpha Beta Simulated_Mean Theoretical_Mean Simulated_Variance
## 1      2     3  1.5       90.16574               90           531.7526
## 2      3     2  2.0      119.68207              120           721.1521
## 3      1     4  0.8       31.94089               32           127.0601
##   Theoretical_Variance
## 1                  540
## 2                  720
## 3                  128</code></pre>
<p>从以上输出结果可以看出，在不同的参数组合下，模拟复合泊松
-伽马过程的均值和方差与理论值非常接近。</p>
<p><strong>HW2</strong></p>
<p><em>5.4</em> Write a function to compute a Monte Carlo estimate of
the Beta(3, 3) cdf, and use the function to estimate F(x) for x
=0.1,0.2,…,0.9. Compare the estimates with the values returned by the
pbeta function in R.</p>
<p><strong>解题思路</strong>：</p>
<p>（1）编写一个估计Beta(3, 3)分布函数的函数 <span class="math inline">\(Beta(\alpha,\beta)=\frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)}\)</span>，
Beta(3, 3)的分布函数为：</p>
<p><span class="math inline">\(F(x)=\int_0^x\frac{1}{Beta(3,3)}t^{2}(1-t)^2dt=30\int_0^xt^{2}(1-t)^2dt\)</span></p>
<p>从而<span class="math inline">\(F(x)=30E_Y[xe^{Y^2(1-Y)^2}],Y\sim
U(0,x)\)</span>，</p>
<p>进而估计函数<span class="math inline">\(\hat{F}(x)=\frac{30}{m}\displaystyle\sum_{i=1}^{m}xe^{Y^2_i(1-Y_i)^2}\)</span>,其中<span class="math inline">\(Y_1,Y_2,...,Y_m~ i.i.d.\sim U(0,x)\)</span></p>
<p>（2）计算当 x 取0.1,0.2,…,0.9时估计函数的值</p>
<p>（3）与真实值进行比较</p>
<p><strong>R代码</strong>：</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># 设置随机种子以便结果可重现</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">gamma</span>(alpha <span class="sc">+</span> beta) <span class="sc">/</span> (<span class="fu">gamma</span>(alpha) <span class="sc">*</span> <span class="fu">gamma</span>(beta))</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co"># 定义 f 函数</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>  r <span class="sc">*</span> x <span class="sc">*</span> (y<span class="sc">^</span>(alpha <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> y)<span class="sc">^</span>(beta <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>}</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co"># 要计算的 x 值</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co"># 生成随机样本</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">lapply</span>(x_values, <span class="cf">function</span>(x) <span class="fu">runif</span>(m, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> x))</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co"># 计算每个 x 的蒙特卡洛估计</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>monte_carlo_estimates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x_values), <span class="cf">function</span>(i) {</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">f</span>(x_values[i], y_values[[i]]))</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>})</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co"># 计算实际的 CDF 值</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>actual_cdf_values <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(x_values, <span class="at">shape1 =</span> alpha, <span class="at">shape2 =</span> beta)</span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co"># 合并结果到数据框</span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a>  <span class="at">x =</span> x_values,</span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a>  <span class="at">monte_carlo_estimate =</span> monte_carlo_estimates,</span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>  <span class="at">actual_cdf_value =</span> actual_cdf_values</span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>)</span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##     x monte_carlo_estimate actual_cdf_value
## 1 0.1          0.008549992          0.00856
## 2 0.2          0.058026386          0.05792
## 3 0.3          0.162850549          0.16308
## 4 0.4          0.318191388          0.31744
## 5 0.5          0.501081622          0.50000
## 6 0.6          0.679956287          0.68256
## 7 0.7          0.836028871          0.83692
## 8 0.8          0.943415396          0.94208
## 9 0.9          0.991099473          0.99144</code></pre>
<p>由上表可以看出，使用蒙特卡洛方法计算得到的Beta(3,3)分布的累计密度函数的估计函数与真实函数在不同的<span class="math inline">\(x\)</span>取值下差异较小。</p>
<p><em>5.9</em> The Rayleigh density [156, (18.76)] is <span class="math inline">\(f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},~~x\geq0,\sigma&gt;0.\)</span>
Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution, using antithetic
variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1,X_2\)</span>?</p>
<p><strong>解题思路</strong>：</p>
<p>（1）利用逆变换方法生成Rayleigh分布
由Rayleigh分布的概率密度函数表达式，可以得到其累计密度函数公式： <span class="math inline">\(F(x)=\int_0^x\frac{t}{\sigma^2}e^{-t^2/(2\sigma^2)}=1-e^{-\frac{x^2}{2\sigma^2}}\)</span></p>
<p>从而<span class="math inline">\(F^{-1}(x)=\sigma\sqrt{-2\ln(1-x)}\)</span>,
则<span class="math inline">\(X=\sigma\sqrt{-2\ln(1-U)}=\sigma\sqrt{-2\ln(U)}\)</span>，其中<span class="math inline">\(U\sim U(0,1)\)</span>，<span class="math inline">\(X\sim Rayleigh(\sigma)\)</span></p>
<p>（2）从Rayleigh分布中抽样，计算利用对偶变量和独立变量生成的方差 <span class="math inline">\(X\)</span>的对偶变量为<span class="math inline">\(X&#39;=\sigma\sqrt{-2\ln(1-U)}\)</span> 独立变量
<span class="math inline">\(X_i=\sigma\sqrt{-2\ln(1-U_i)}\)</span>，其中<span class="math inline">\(U_i\sim U(0,1),~i=1,2\)</span>，且<span class="math inline">\(U、U_1、U_2\)</span>独立</p>
<p>（3）计算利用对偶变量的方差减小率
方差减小率=(独立样本方差-对偶样本方差)/独立样本方差*100%</p>
<p><strong>R代码</strong>：</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># 设置随机种子以便结果可重现</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># 生成 Rayleigh 分布样本的函数</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>rayleigh_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, size) {</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(size)  <span class="co"># 生成 U(0,1) 的随机数</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="fu">return</span>(sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U)))  <span class="co"># 通过逆变换法生成 Rayleigh 样本</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>}</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co"># 使用对偶变量生成 Rayleigh 样本</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>rayleigh_antithetic <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, size) {</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(size)  <span class="co"># 生成 U(0,1) 的随机数</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>  X <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U))  <span class="co"># 原始 Rayleigh 样本</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>  X_prime <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> U))  <span class="co"># 对偶 Rayleigh 样本</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X =</span> X, <span class="at">X_prime =</span> X_prime))  <span class="co"># 返回一对对偶变量</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>}</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co"># 计算方差减小率</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>variance_reduction <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, size) {</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>  <span class="co"># 生成独立的样本</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">rayleigh_sample</span>(sigma, size)</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> <span class="fu">rayleigh_sample</span>(sigma, size)</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>  independent_mean <span class="ot">&lt;-</span> (X1 <span class="sc">+</span> X2) <span class="sc">/</span> <span class="dv">2</span>  <span class="co"># 计算独立样本的平均值</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a>  </span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>  <span class="co"># 生成对偶变量样本</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>  antithetic_samples <span class="ot">&lt;-</span> <span class="fu">rayleigh_antithetic</span>(sigma, size)</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>  X <span class="ot">&lt;-</span> antithetic_samples<span class="sc">$</span>X</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>  X_prime <span class="ot">&lt;-</span> antithetic_samples<span class="sc">$</span>X_prime</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a>  antithetic_mean <span class="ot">&lt;-</span> (X <span class="sc">+</span> X_prime) <span class="sc">/</span> <span class="dv">2</span>  <span class="co"># 计算对偶变量的平均值</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a>  </span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>  <span class="co"># 计算方差</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a>  var_independent <span class="ot">&lt;-</span> <span class="fu">var</span>(independent_mean)</span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a>  var_antithetic <span class="ot">&lt;-</span> <span class="fu">var</span>(antithetic_mean)</span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a>  </span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a>  <span class="co"># 计算方差减小率</span></span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a>  reduction <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (var_independent <span class="sc">-</span> var_antithetic) <span class="sc">/</span> var_independent</span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">reduction =</span> reduction, <span class="at">var_independent =</span> var_independent, <span class="at">var_antithetic =</span> var_antithetic))</span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a>}</span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a></span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a><span class="co"># 运行示例</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">variance_reduction</span>(sigma, size)</span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a></span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;独立样本的方差:&quot;</span>, result<span class="sc">$</span>var_independent, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 独立样本的方差: 0.2149182</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;对偶样本的方差:&quot;</span>, result<span class="sc">$</span>var_antithetic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 对偶样本的方差: 0.01115031</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;方差减小率:&quot;</span>, result<span class="sc">$</span>reduction, <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 方差减小率: 94.81184 %</code></pre>
<p>从以上结果可以看出，当<span class="math inline">\(\sigma=1\)</span>时，使用对偶样本使方差降低了近95%（样本量取100000），方差减少效果显著。</p>
<p><em>5.13</em> Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math inline">\(g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},~~x&gt;1.\)</span>
Which of your two importance functions should produce the smaller
variance in estimating <span class="math inline">\(\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\)</span>
by importance sampling? Explain.</p>
<p><strong>解题思路</strong>：</p>
<p>（1）选取两个与<span class="math inline">\(g(x)\)</span>形式接近的函数
选取标准正态分布的概率密度函数： <span class="math inline">\(f_1(x)=\frac{1}{\sqrt{2\pi}}e^{-x^2/2}\)</span>
选取Rayleigh(1)的概率密度函数： <span class="math inline">\(f_2(x)=xe^{-x^2/2}\)</span></p>
<p>（2）对<span class="math inline">\(\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\)</span>进行估计
<span class="math inline">\(I_1=\frac{1}{n}\displaystyle\sum_{i=1}^n\frac{g(x_i)I(x_i&gt;1)}{f_1(x_i)}\)</span>
<span class="math inline">\(I_2=\frac{1}{n}\displaystyle\sum_{i=1}^n\frac{g(x_i)I(x_i&gt;1)}{f_2(x_i)}\)</span></p>
<p>（3）比较两个估计方法的方差</p>
<p><strong>代码</strong></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># 设置随机种子以便结果可重现</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co"># 定义 g(x)</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">0</span>, (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>}</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co"># 定义 f1(x) 和 f2(x)</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>}</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>  x <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>}</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="co"># 生成 Rayleigh 分布样本的函数</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>rayleigh_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, size) {</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(size)  <span class="co"># 生成 U(0,1) 的随机数</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>  <span class="fu">return</span>(sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U)))  <span class="co"># 通过逆变换法生成 Rayleigh 样本</span></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>}</span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a><span class="co"># 从 f1 和 f2 中生成样本</span></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a>sample_from_f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>  <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)  <span class="co"># 从正态分布中生成样本</span></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a>}</span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a>sample_from_f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a>  <span class="fu">rayleigh_sample</span>(<span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">size =</span> n)  <span class="co"># 使用自定义函数生成Rayleigh样本</span></span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a>}</span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a></span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a><span class="co"># 进行重要性采样</span></span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span>  <span class="co"># 样本大小</span></span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a>num_runs <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># 重复次数</span></span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a>II1_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_runs)</span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a>II2_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_runs)</span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a></span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_runs) {</span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a>  tt1 <span class="ot">&lt;-</span> <span class="fu">sample_from_f1</span>(n)</span>
<span id="cb20-41"><a href="#cb20-41" tabindex="-1"></a>  I1 <span class="ot">&lt;-</span> <span class="fu">g</span>(tt1) <span class="sc">/</span> <span class="fu">f1</span>(tt1)</span>
<span id="cb20-42"><a href="#cb20-42" tabindex="-1"></a>  II1_values[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(I1)</span>
<span id="cb20-43"><a href="#cb20-43" tabindex="-1"></a>  </span>
<span id="cb20-44"><a href="#cb20-44" tabindex="-1"></a>  tt2 <span class="ot">&lt;-</span> <span class="fu">sample_from_f2</span>(n)</span>
<span id="cb20-45"><a href="#cb20-45" tabindex="-1"></a>  I2 <span class="ot">&lt;-</span> <span class="fu">g</span>(tt2) <span class="sc">/</span> <span class="fu">f2</span>(tt2)</span>
<span id="cb20-46"><a href="#cb20-46" tabindex="-1"></a>  II2_values[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(I2)</span>
<span id="cb20-47"><a href="#cb20-47" tabindex="-1"></a>}</span>
<span id="cb20-48"><a href="#cb20-48" tabindex="-1"></a></span>
<span id="cb20-49"><a href="#cb20-49" tabindex="-1"></a><span class="co"># 计算方差</span></span>
<span id="cb20-50"><a href="#cb20-50" tabindex="-1"></a>var_II1 <span class="ot">&lt;-</span> <span class="fu">var</span>(II1_values)</span>
<span id="cb20-51"><a href="#cb20-51" tabindex="-1"></a>var_II2 <span class="ot">&lt;-</span> <span class="fu">var</span>(II2_values)</span>
<span id="cb20-52"><a href="#cb20-52" tabindex="-1"></a></span>
<span id="cb20-53"><a href="#cb20-53" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb20-54"><a href="#cb20-54" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimate using f1:&quot;</span>, <span class="fu">mean</span>(II1_values), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Estimate using f1: 0.4007532</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Variance using f1:&quot;</span>, var_II1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Variance using f1: 1.438138e-05</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimate using f2:&quot;</span>, <span class="fu">mean</span>(II2_values), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Estimate using f2: 0.4007129</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Variance using f2:&quot;</span>, var_II2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Variance using f2: 1.363178e-06</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># 真实的积分值（可以通过数值积分计算）</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>true_value <span class="ot">&lt;-</span> <span class="fu">integrate</span>(g, <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;True value of the integral:&quot;</span>, true_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## True value of the integral: 0.400626</code></pre>
<p>从以上结果可以看出，选取的两个重要性函数<span class="math inline">\(f_1(x)=\frac{1}{\sqrt{2\pi}}e^{-x^2/2}\)</span>和<span class="math inline">\(f_2(x)=xe^{-x^2/2}\)</span>最后得到的<span class="math inline">\(\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\)</span>估计值都与真实值较为接近，而选取<span class="math inline">\(f_2(x)=xe^{-x^2/2}\)</span>作为重要性函数的估计方差更小（小了一个数量级），且估计值更接近真实值。</p>
<p><em>Monte Carlo experiment</em> For <span class="math inline">\(n =
10^4,2×10^4,4×10^4,6×10^4,8×10^4\)</span>, apply the fast sorting
algorithm to randomly permuted numbers of 1,…,n. Calculate computation
time averaged over 100 simulations, denoted by <span class="math inline">\(a_n\)</span>. Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n :=
nlog(n)\)</span>, and graphically show the results (scatter plot and
regression line).</p>
<p><strong>解题思路</strong></p>
<p>（1）利用快速排序算法对<span class="math inline">\(n =
10^4,2×10^4,4×10^4,6×10^4,8×10^4\)</span>这五种情况进行排序</p>
<p>（2）计算100次模拟的平均时间</p>
<p>（3）对<span class="math inline">\(a_n\)</span>和<span class="math inline">\(t_n := nlog(n)\)</span>进行回归并绘制图像</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># 加载必要的库</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># 设置随机种子以便结果可重现</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="co"># 快速排序算法</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>quicksort <span class="ot">&lt;-</span> <span class="cf">function</span>(arr) {</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(arr) <span class="sc">&lt;=</span> <span class="dv">1</span>) {</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>    <span class="fu">return</span>(arr)</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>  }</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>  </span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>  pivot <span class="ot">&lt;-</span> arr[<span class="fu">sample</span>(<span class="fu">length</span>(arr), <span class="dv">1</span>)]  <span class="co"># 随机选择一个枢轴</span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>  left <span class="ot">&lt;-</span> arr[arr <span class="sc">&lt;</span> pivot]</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>  right <span class="ot">&lt;-</span> arr[arr <span class="sc">&gt;</span> pivot]</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>  </span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quicksort</span>(left), pivot, <span class="fu">quicksort</span>(right)))</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a>}</span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a><span class="co"># 运行蒙特卡洛实验的函数</span></span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a>run_experiment <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">simulations =</span> <span class="dv">100</span>) {</span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">numeric</span>(simulations)</span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a>  </span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>simulations) {</span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a>    permuted_numbers <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n)  <span class="co"># 生成随机排列</span></span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a>    start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()  <span class="co"># 开始计时</span></span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a>    <span class="fu">quicksort</span>(permuted_numbers)  <span class="co"># 排序</span></span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a>    end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()  <span class="co"># 结束计时</span></span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a>    times[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(end_time, start_time, <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>))</span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a>  }</span>
<span id="cb32-27"><a href="#cb32-27" tabindex="-1"></a>  </span>
<span id="cb32-28"><a href="#cb32-28" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(times))  <span class="co"># 返回平均时间</span></span>
<span id="cb32-29"><a href="#cb32-29" tabindex="-1"></a>}</span>
<span id="cb32-30"><a href="#cb32-30" tabindex="-1"></a></span>
<span id="cb32-31"><a href="#cb32-31" tabindex="-1"></a><span class="co"># 测试的 n 值</span></span>
<span id="cb32-32"><a href="#cb32-32" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">6</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">8</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb32-33"><a href="#cb32-33" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n =</span> n_values, <span class="at">a_n =</span> <span class="cn">NA</span>)</span>
<span id="cb32-34"><a href="#cb32-34" tabindex="-1"></a></span>
<span id="cb32-35"><a href="#cb32-35" tabindex="-1"></a><span class="co"># 对每个 n 运行实验</span></span>
<span id="cb32-36"><a href="#cb32-36" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> n_values) {</span>
<span id="cb32-37"><a href="#cb32-37" tabindex="-1"></a>  results<span class="sc">$</span>a_n[results<span class="sc">$</span>n <span class="sc">==</span> n] <span class="ot">&lt;-</span> <span class="fu">run_experiment</span>(n)</span>
<span id="cb32-38"><a href="#cb32-38" tabindex="-1"></a>}</span>
<span id="cb32-39"><a href="#cb32-39" tabindex="-1"></a></span>
<span id="cb32-40"><a href="#cb32-40" tabindex="-1"></a><span class="co"># 计算 t_n = n * log(n)</span></span>
<span id="cb32-41"><a href="#cb32-41" tabindex="-1"></a>results<span class="sc">$</span>t_n <span class="ot">&lt;-</span> results<span class="sc">$</span>n <span class="sc">*</span> <span class="fu">log</span>(results<span class="sc">$</span>n)</span>
<span id="cb32-42"><a href="#cb32-42" tabindex="-1"></a></span>
<span id="cb32-43"><a href="#cb32-43" tabindex="-1"></a><span class="co"># 线性回归</span></span>
<span id="cb32-44"><a href="#cb32-44" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(a_n <span class="sc">~</span> t_n, <span class="at">data =</span> results)</span>
<span id="cb32-45"><a href="#cb32-45" tabindex="-1"></a></span>
<span id="cb32-46"><a href="#cb32-46" tabindex="-1"></a><span class="co"># 回归模型的摘要</span></span>
<span id="cb32-47"><a href="#cb32-47" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = a_n ~ t_n, data = results)
## 
## Residuals:
##          1          2          3          4          5 
## -0.0023597  0.0005276  0.0014560  0.0034725 -0.0030964 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.189e-02  2.571e-03   4.624    0.019 *  
## t_n         4.297e-07  4.728e-09  90.882 2.94e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.003142 on 3 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9995 
## F-statistic:  8259 on 1 and 3 DF,  p-value: 2.937e-06</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co"># 绘制结果</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(<span class="at">x =</span> t_n, <span class="at">y =</span> a_n)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;平均计算时间与 t_n 的关系&quot;</span>,</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;t_n = n log(n)&quot;</span>,</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;平均计算时间（秒）&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>HW3</strong></p>
<p><em>6.6</em> Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of
the skewness <span class="math inline">\(\sqrt{b_1}\)</span> under
normality by a Monte Carlo experiment. Compute the standard error of the
estimates from (2.14) using the normal approximation for the density
(with exact variance formula). Compare the estimated quantiles with the
quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_1}\approx N(0,6/n).\)</span></p>
<p><strong>解题思路</strong>：</p>
<p>（1）生成10000组服从标准正态分布的数据，并计算出样本偏度以及样本偏度的分位数</p>
<p>（2）使用精确方差公式<span class="math inline">\(Var(\hat{x}_q)=\frac{q(1
−q)}{nf({x}_q)^2}\)</span>计算分位数的标准误差</p>
<p>（3）将估计的分位数与近似分布<span class="math inline">\(N(0,6/n)\)</span>的分位数进行比较</p>
<p><strong>R代码</strong>：</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co"># 加载必要的库</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 每组样本大小</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>num_groups <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 组数</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="co"># 存储偏度值</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>skewness_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_groups)</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a><span class="co"># 生成 10000 组标准正态分布数据并计算样本偏度</span></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)  <span class="co"># 设置随机种子以保证结果可重复</span></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_groups) {</span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)  <span class="co"># 从标准正态分布中生成样本</span></span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a>  skewness_values[i] <span class="ot">&lt;-</span> <span class="fu">skewness</span>(sample_data)  <span class="co"># 计算偏度</span></span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a>}</span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a><span class="co"># 计算样本偏度的分位数</span></span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a>quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(skewness_values, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>))</span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;样本偏度的分位数:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;样本偏度的分位数:&quot;</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">print</span>(quantiles)</span></code></pre></div>
<pre><code>##        2.5%          5%         95%       97.5% 
## -0.04747767 -0.04015713  0.03990821  0.04810421</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># 计算分位数的标准误差</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a><span class="co"># 先计算偏度分布的密度函数值</span></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>density_values <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(quantiles)  <span class="co"># 计算分位数的密度值</span></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a><span class="co"># 计算标准误差</span></span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>standard_errors <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>))) <span class="sc">/</span> (num_groups <span class="sc">*</span> density_values<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;分位数的标准误差:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 分位数的标准误差:</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">print</span>(standard_errors)</span></code></pre></div>
<pre><code>##        2.5%          5%         95%       97.5% 
## 0.003917885 0.005467476 0.005467422 0.003918003</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># 计算近似分布 N(0, 6/n) 的分位数</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>standard_deviation <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">6</span> <span class="sc">/</span> n)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>approx_quantiles <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> standard_deviation)</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;近似分布 N(0, 6/n) 的分位数:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;近似分布 N(0, 6/n) 的分位数:&quot;</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">print</span>(approx_quantiles)</span></code></pre></div>
<pre><code>## [1] -0.04800912 -0.04029052  0.04029052  0.04800912</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="co"># 比较结果</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>  <span class="at">Quantiles =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>),</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>  <span class="at">Sample_Quantiles =</span> quantiles,</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>  <span class="at">Approx_Quantiles =</span> approx_quantiles</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>)</span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;分位数比较:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;分位数比较:&quot;</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code></pre></div>
<pre><code>##       Quantiles Sample_Quantiles Approx_Quantiles
## 2.5%      0.025      -0.04747767      -0.04800912
## 5%        0.050      -0.04015713      -0.04029052
## 95%       0.950       0.03990821       0.04029052
## 97.5%     0.975       0.04810421       0.04800912</code></pre>
<p>结果如上所示，在大样本情况下，样本偏度估计的分位数与近似分布<span class="math inline">\(N(0,6/n)\)</span>的分位数非常接近</p>
<p><em>6.B</em> Tests for association based on Pearson product moment
correlation <span class="math inline">\(ρ\)</span>,Spear-man’s rank
correlation coefficient <span class="math inline">\(ρ_s\)</span>, or
Kendall’s coefficient <span class="math inline">\(τ\)</span>, are
imple-mented in cor.test. Show (empirically) that the nonparametric
tests based on <span class="math inline">\(ρ_s\)</span> or <span class="math inline">\(τ\)</span> are less powerful than the correlation
test when the sampled dis-tribution is bivariate normal. Find an example
of an alternative (a bivariate distribution <span class="math inline">\((X,Y)\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one
of the nonparametric tests have better empirical power than the
correlation test against this alternative.</p>
<p><strong>解题思路</strong>：</p>
<p>（1）设<span class="math inline">\(X\sim Exp(1)\)</span>，令<span class="math inline">\(Y=X^{0.4}+t_{10}\)</span>，针对<span class="math inline">\((X,Y)\)</span>
计算Pearson相关系数、Spearman秩相关系数以及Kendall相关系数</p>
<p>（2）对三个相关系数检验的功效进行比较</p>
<p><strong>R代码</strong>：</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)  <span class="co"># 设置随机种子以保证可重复性</span></span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># 每次模拟的样本大小</span></span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>simulations <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 总模拟次数</span></span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>  <span class="co"># 显著性水平</span></span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a><span class="co"># 存储功效的计数</span></span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>pearson_power <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>spearman_power <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>kendall_power <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" tabindex="-1"></a><span class="co"># 进行模拟</span></span>
<span id="cb52-13"><a href="#cb52-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>simulations) {</span>
<span id="cb52-14"><a href="#cb52-14" tabindex="-1"></a>  <span class="co"># 生成数据</span></span>
<span id="cb52-15"><a href="#cb52-15" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n)  <span class="co"># 生成一个有序的序列</span></span>
<span id="cb52-16"><a href="#cb52-16" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> X<span class="sc">^</span><span class="fl">0.4</span> <span class="sc">+</span> <span class="fu">rt</span>(n, <span class="dv">10</span>) <span class="co"># Y 是 X 的对数加上一定的噪声</span></span>
<span id="cb52-17"><a href="#cb52-17" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" tabindex="-1"></a>  <span class="co"># 对于每种检验，进行假设检验</span></span>
<span id="cb52-19"><a href="#cb52-19" tabindex="-1"></a>  pearson_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y)</span>
<span id="cb52-20"><a href="#cb52-20" tabindex="-1"></a>  spearman_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb52-21"><a href="#cb52-21" tabindex="-1"></a>  kendall_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb52-22"><a href="#cb52-22" tabindex="-1"></a></span>
<span id="cb52-23"><a href="#cb52-23" tabindex="-1"></a>  <span class="co"># 检查功效</span></span>
<span id="cb52-24"><a href="#cb52-24" tabindex="-1"></a>  <span class="cf">if</span> (pearson_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb52-25"><a href="#cb52-25" tabindex="-1"></a>    pearson_power <span class="ot">&lt;-</span> pearson_power <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb52-26"><a href="#cb52-26" tabindex="-1"></a>  }</span>
<span id="cb52-27"><a href="#cb52-27" tabindex="-1"></a>  <span class="cf">if</span> (spearman_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb52-28"><a href="#cb52-28" tabindex="-1"></a>    spearman_power <span class="ot">&lt;-</span> spearman_power <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb52-29"><a href="#cb52-29" tabindex="-1"></a>  }</span>
<span id="cb52-30"><a href="#cb52-30" tabindex="-1"></a>  <span class="cf">if</span> (kendall_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb52-31"><a href="#cb52-31" tabindex="-1"></a>    kendall_power <span class="ot">&lt;-</span> kendall_power <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb52-32"><a href="#cb52-32" tabindex="-1"></a>  }</span>
<span id="cb52-33"><a href="#cb52-33" tabindex="-1"></a>}</span>
<span id="cb52-34"><a href="#cb52-34" tabindex="-1"></a></span>
<span id="cb52-35"><a href="#cb52-35" tabindex="-1"></a><span class="co"># 计算功效</span></span>
<span id="cb52-36"><a href="#cb52-36" tabindex="-1"></a>pearson_effectiveness <span class="ot">&lt;-</span> pearson_power <span class="sc">/</span> simulations</span>
<span id="cb52-37"><a href="#cb52-37" tabindex="-1"></a>spearman_effectiveness <span class="ot">&lt;-</span> spearman_power <span class="sc">/</span> simulations</span>
<span id="cb52-38"><a href="#cb52-38" tabindex="-1"></a>kendall_effectiveness <span class="ot">&lt;-</span> kendall_power <span class="sc">/</span> simulations</span>
<span id="cb52-39"><a href="#cb52-39" tabindex="-1"></a></span>
<span id="cb52-40"><a href="#cb52-40" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb52-41"><a href="#cb52-41" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;皮尔逊检验的功效:&quot;</span>, pearson_effectiveness, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 皮尔逊检验的功效: 0.8714</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;斯皮尔曼检验的功效:&quot;</span>, spearman_effectiveness, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 斯皮尔曼检验的功效: 0.9067</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;肯德尔检验的功效:&quot;</span>, kendall_effectiveness, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 肯德尔检验的功效: 0.9059</code></pre>
<p>从以上结果可以看出，后两种检验方法的功效好于皮尔逊检验。</p>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. We want to know if the powers are different at 0.05
level. What is the corresponding hypothesis test problem? What test
should we use? Z-test, two-sample t-test, paired-t test or McNemar test?
Why? Please provide the least necessary information for hypothesis
testing.</p>
<p><strong>解题思路</strong>：</p>
<p>（1）确定原假设为：<span class="math inline">\(H_0:两种方法的功效相等\)</span></p>
<p>（2）由于我们比较的是两个独立样本，并且在样本量较大的情况下（1000次实验），正态近似是合理的，适合用<span class="math inline">\(z\)</span>检验</p>
<p><strong>R代码</strong>：</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.651</span>  <span class="co"># 第一种方法的功效</span></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fl">0.676</span>  <span class="co"># 第二种方法的功效</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 第一种方法的实验次数</span></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 第二种方法的实验次数</span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a><span class="co"># 计算成功次数</span></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> p1 <span class="sc">*</span> n1</span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> p2 <span class="sc">*</span> n2</span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a><span class="co"># 计算合并比例</span></span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>p <span class="ot">&lt;-</span> (X1 <span class="sc">+</span> X2) <span class="sc">/</span> (n1 <span class="sc">+</span> n2)</span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a></span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a><span class="co"># 计算Z统计量</span></span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a>Z <span class="ot">&lt;-</span> (p1 <span class="sc">-</span> p2) <span class="sc">/</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>n1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2))</span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a></span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a><span class="co"># 计算p值</span></span>
<span id="cb58-18"><a href="#cb58-18" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(Z)))  <span class="co"># 双尾检验</span></span>
<span id="cb58-19"><a href="#cb58-19" tabindex="-1"></a></span>
<span id="cb58-20"><a href="#cb58-20" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb58-21"><a href="#cb58-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Z统计量:&quot;</span>, Z, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Z统计量: -3.741209</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## p值: 0.0001831369</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="co"># 判断是否拒绝零假设</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;拒绝零假设：两种方法的功效有显著差异。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;未拒绝零假设：两种方法的功效没有显著差异。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 拒绝零假设：两种方法的功效有显著差异。</code></pre>
<p>从以上的结果可以看出，<span class="math inline">\(p=0.00018&lt;0.05\)</span>，故拒绝原假设，在显著性水平为0.05下认为两种方法的功效具有差异。</p>
<p><strong>HW4</strong></p>
<p>Of N =1000 hypotheses, 950 are null and 50 are alternative. The
p-value under any null hypothesis is uniformly distributed (use runif),
and the p-value under any alternative hypothesis follows the beta
distribution with parameter 0.1 and 1 (use rbeta). Obtain Bonferroni
adjusted p-values and B-H adjusted p-values. Calculate FWER, FDR, and
TPR under nominal level α =0.1 for each of the two adjustment methods
based on m=10000 simulation replicates. You should output the 6 numbers
(3 ) to a 3×2 table (column names: Bonferroni correction, B-H
correction; row names: FWER, FDR, TPR). Comment the results.</p>
<p><strong>解题思路</strong>：</p>
<p>(1)计算在显著性水平为0.1下 Bonferroni 调整方法和 B-H
调整方法的FWER,FDR和TPR值</p>
<p>(2)输出结果表格</p>
<p><strong>R代码</strong>：</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="co"># 设置随机种子以便结果可重现</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 总的假设个数</span></span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>n_null <span class="ot">&lt;-</span> <span class="dv">950</span>  <span class="co"># 真假设的数量</span></span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>n_alt <span class="ot">&lt;-</span> <span class="dv">50</span>  <span class="co"># 假假设的数量</span></span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>  <span class="co"># 显著性水平</span></span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 模拟次数</span></span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a><span class="co"># Bonferroni校正函数</span></span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a>bonferroni_correction <span class="ot">&lt;-</span> <span class="cf">function</span>(p_values, alpha) {</span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a>}</span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a><span class="co"># BH校正函数</span></span>
<span id="cb64-16"><a href="#cb64-16" tabindex="-1"></a>bh_correction <span class="ot">&lt;-</span> <span class="cf">function</span>(p_values, alpha) {</span>
<span id="cb64-17"><a href="#cb64-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>))</span>
<span id="cb64-18"><a href="#cb64-18" tabindex="-1"></a>}</span>
<span id="cb64-19"><a href="#cb64-19" tabindex="-1"></a></span>
<span id="cb64-20"><a href="#cb64-20" tabindex="-1"></a><span class="co"># 进行一次假设检验的模拟</span></span>
<span id="cb64-21"><a href="#cb64-21" tabindex="-1"></a>simulate_hypothesis_test <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb64-22"><a href="#cb64-22" tabindex="-1"></a>  <span class="co"># 真假设的 p 值（均匀分布）</span></span>
<span id="cb64-23"><a href="#cb64-23" tabindex="-1"></a>  p_null <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_null)</span>
<span id="cb64-24"><a href="#cb64-24" tabindex="-1"></a>  </span>
<span id="cb64-25"><a href="#cb64-25" tabindex="-1"></a>  <span class="co"># 假假设的 p 值（Beta 分布）</span></span>
<span id="cb64-26"><a href="#cb64-26" tabindex="-1"></a>  p_alt <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n_alt, <span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb64-27"><a href="#cb64-27" tabindex="-1"></a>  </span>
<span id="cb64-28"><a href="#cb64-28" tabindex="-1"></a>  <span class="co"># 合并 p 值</span></span>
<span id="cb64-29"><a href="#cb64-29" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(p_null, p_alt)</span>
<span id="cb64-30"><a href="#cb64-30" tabindex="-1"></a>  </span>
<span id="cb64-31"><a href="#cb64-31" tabindex="-1"></a>  <span class="co"># Bonferroni 校正</span></span>
<span id="cb64-32"><a href="#cb64-32" tabindex="-1"></a>  bonferroni_p <span class="ot">&lt;-</span> <span class="fu">bonferroni_correction</span>(p_values, alpha)</span>
<span id="cb64-33"><a href="#cb64-33" tabindex="-1"></a>  </span>
<span id="cb64-34"><a href="#cb64-34" tabindex="-1"></a>  <span class="co"># BH 校正</span></span>
<span id="cb64-35"><a href="#cb64-35" tabindex="-1"></a>  bh_p <span class="ot">&lt;-</span> <span class="fu">bh_correction</span>(p_values, alpha)</span>
<span id="cb64-36"><a href="#cb64-36" tabindex="-1"></a>  </span>
<span id="cb64-37"><a href="#cb64-37" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">p_values =</span> p_values, <span class="at">bonferroni_p =</span> bonferroni_p, <span class="at">bh_p =</span> bh_p))</span>
<span id="cb64-38"><a href="#cb64-38" tabindex="-1"></a>}</span>
<span id="cb64-39"><a href="#cb64-39" tabindex="-1"></a></span>
<span id="cb64-40"><a href="#cb64-40" tabindex="-1"></a><span class="co"># 初始化结果储存变量</span></span>
<span id="cb64-41"><a href="#cb64-41" tabindex="-1"></a>bonferroni_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">FWER =</span> <span class="dv">0</span>, <span class="at">FDR =</span> <span class="dv">0</span>, <span class="at">TPR =</span> <span class="dv">0</span>)</span>
<span id="cb64-42"><a href="#cb64-42" tabindex="-1"></a>bh_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">FWER =</span> <span class="dv">0</span>, <span class="at">FDR =</span> <span class="dv">0</span>, <span class="at">TPR =</span> <span class="dv">0</span>)</span>
<span id="cb64-43"><a href="#cb64-43" tabindex="-1"></a></span>
<span id="cb64-44"><a href="#cb64-44" tabindex="-1"></a><span class="co"># 多次模拟实验</span></span>
<span id="cb64-45"><a href="#cb64-45" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb64-46"><a href="#cb64-46" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">simulate_hypothesis_test</span>()</span>
<span id="cb64-47"><a href="#cb64-47" tabindex="-1"></a>  </span>
<span id="cb64-48"><a href="#cb64-48" tabindex="-1"></a>  <span class="co"># Bonferroni校正结果</span></span>
<span id="cb64-49"><a href="#cb64-49" tabindex="-1"></a>  bonferroni_reject <span class="ot">&lt;-</span> result<span class="sc">$</span>bonferroni_p <span class="sc">&lt;=</span> alpha</span>
<span id="cb64-50"><a href="#cb64-50" tabindex="-1"></a>  bonferroni_FWER <span class="ot">&lt;-</span> <span class="fu">any</span>(bonferroni_reject[<span class="dv">1</span><span class="sc">:</span>n_null])</span>
<span id="cb64-51"><a href="#cb64-51" tabindex="-1"></a>  bonferroni_FDR <span class="ot">&lt;-</span> <span class="fu">sum</span>(bonferroni_reject[<span class="dv">1</span><span class="sc">:</span>n_null]) <span class="sc">/</span> <span class="fu">max</span>(<span class="dv">1</span>, <span class="fu">sum</span>(bonferroni_reject))</span>
<span id="cb64-52"><a href="#cb64-52" tabindex="-1"></a>  bonferroni_TPR <span class="ot">&lt;-</span> <span class="fu">sum</span>(bonferroni_reject[(n_null <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]) <span class="sc">/</span> n_alt</span>
<span id="cb64-53"><a href="#cb64-53" tabindex="-1"></a>  </span>
<span id="cb64-54"><a href="#cb64-54" tabindex="-1"></a>  bonferroni_results<span class="sc">$</span>FWER <span class="ot">&lt;-</span> bonferroni_results<span class="sc">$</span>FWER <span class="sc">+</span> bonferroni_FWER</span>
<span id="cb64-55"><a href="#cb64-55" tabindex="-1"></a>  bonferroni_results<span class="sc">$</span>FDR <span class="ot">&lt;-</span> bonferroni_results<span class="sc">$</span>FDR <span class="sc">+</span> bonferroni_FDR</span>
<span id="cb64-56"><a href="#cb64-56" tabindex="-1"></a>  bonferroni_results<span class="sc">$</span>TPR <span class="ot">&lt;-</span> bonferroni_results<span class="sc">$</span>TPR <span class="sc">+</span> bonferroni_TPR</span>
<span id="cb64-57"><a href="#cb64-57" tabindex="-1"></a>  </span>
<span id="cb64-58"><a href="#cb64-58" tabindex="-1"></a>  <span class="co"># BH校正结果</span></span>
<span id="cb64-59"><a href="#cb64-59" tabindex="-1"></a>  bh_reject <span class="ot">&lt;-</span> result<span class="sc">$</span>bh_p <span class="sc">&lt;=</span> alpha</span>
<span id="cb64-60"><a href="#cb64-60" tabindex="-1"></a>  bh_FWER <span class="ot">&lt;-</span> <span class="fu">any</span>(bh_reject[<span class="dv">1</span><span class="sc">:</span>n_null])</span>
<span id="cb64-61"><a href="#cb64-61" tabindex="-1"></a>  bh_FDR <span class="ot">&lt;-</span> <span class="fu">sum</span>(bh_reject[<span class="dv">1</span><span class="sc">:</span>n_null]) <span class="sc">/</span> <span class="fu">max</span>(<span class="dv">1</span>, <span class="fu">sum</span>(bh_reject))</span>
<span id="cb64-62"><a href="#cb64-62" tabindex="-1"></a>  bh_TPR <span class="ot">&lt;-</span> <span class="fu">sum</span>(bh_reject[(n_null <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]) <span class="sc">/</span> n_alt</span>
<span id="cb64-63"><a href="#cb64-63" tabindex="-1"></a>  </span>
<span id="cb64-64"><a href="#cb64-64" tabindex="-1"></a>  bh_results<span class="sc">$</span>FWER <span class="ot">&lt;-</span> bh_results<span class="sc">$</span>FWER <span class="sc">+</span> bh_FWER</span>
<span id="cb64-65"><a href="#cb64-65" tabindex="-1"></a>  bh_results<span class="sc">$</span>FDR <span class="ot">&lt;-</span> bh_results<span class="sc">$</span>FDR <span class="sc">+</span> bh_FDR</span>
<span id="cb64-66"><a href="#cb64-66" tabindex="-1"></a>  bh_results<span class="sc">$</span>TPR <span class="ot">&lt;-</span> bh_results<span class="sc">$</span>TPR <span class="sc">+</span> bh_TPR</span>
<span id="cb64-67"><a href="#cb64-67" tabindex="-1"></a>}</span>
<span id="cb64-68"><a href="#cb64-68" tabindex="-1"></a></span>
<span id="cb64-69"><a href="#cb64-69" tabindex="-1"></a><span class="co"># 计算平均值</span></span>
<span id="cb64-70"><a href="#cb64-70" tabindex="-1"></a>bonferroni_results <span class="ot">&lt;-</span> bonferroni_results <span class="sc">/</span> m</span>
<span id="cb64-71"><a href="#cb64-71" tabindex="-1"></a>bh_results <span class="ot">&lt;-</span> bh_results <span class="sc">/</span> m</span>
<span id="cb64-72"><a href="#cb64-72" tabindex="-1"></a></span>
<span id="cb64-73"><a href="#cb64-73" tabindex="-1"></a><span class="co"># 创建结果表格</span></span>
<span id="cb64-74"><a href="#cb64-74" tabindex="-1"></a>results_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb64-75"><a href="#cb64-75" tabindex="-1"></a>  <span class="st">&quot;Bonferroni correction&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(bonferroni_results<span class="sc">$</span>FWER, bonferroni_results<span class="sc">$</span>FDR, bonferroni_results<span class="sc">$</span>TPR),</span>
<span id="cb64-76"><a href="#cb64-76" tabindex="-1"></a>  <span class="st">&quot;B-H correction&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(bh_results<span class="sc">$</span>FWER, bh_results<span class="sc">$</span>FDR, bh_results<span class="sc">$</span>TPR)</span>
<span id="cb64-77"><a href="#cb64-77" tabindex="-1"></a>)</span>
<span id="cb64-78"><a href="#cb64-78" tabindex="-1"></a><span class="fu">rownames</span>(results_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb64-79"><a href="#cb64-79" tabindex="-1"></a></span>
<span id="cb64-80"><a href="#cb64-80" tabindex="-1"></a><span class="co"># 输出结果表格</span></span>
<span id="cb64-81"><a href="#cb64-81" tabindex="-1"></a><span class="fu">print</span>(results_table)</span></code></pre></div>
<pre><code>##      Bonferroni.correction B.H.correction
## FWER           0.094400000     0.92900000
## FDR            0.004830419     0.09429707
## TPR            0.398360000     0.56145800</code></pre>
<p>从以上结果可以看出 Bonferroni 调整方法得到的 FWER
约等于0.094，接近假定的显著性水平<span class="math inline">\(\alpha=0.1\)</span>。但是 B-H 调整方法得到的 FWER
接近0.93，较接近1，这说明 B-H 调整方法对于控制 FWER 并不严格；Bonferroni
调整方法得到的 FDR 非常低，较保守，B-H 调整方法得到的 FDR
接近假定的显著性水平<span class="math inline">\(\alpha=0.1\)</span>；Bonferroni 调整方法得到的 TPR
低于 B-H 调整方法，说明B-H 调整方法在检验真阳性方面的能力更高。</p>
<p><strong>7.4</strong> Refer to the air-conditioning data set aircondit
provided in the boot package. The 12 observations are the times in hours
between failures of airconditioning equipment [63, Example 1.1]: <span class="math display">\[
3,5,7,18,43,85,91,98,100,130,230,487.
\]</span> Assume that the times between failures follow an exponential
model Exp(λ).Obtain the MLE of the hazard rate λ and use bootstrap to
estimate the bias and standard error of the estimate.</p>
<p><strong>解题思路</strong>：</p>
<p>(1)首先计算<span class="math inline">\(\lambda\)</span>的最大似然估计。对于指数分布，其概率密度函数为：
<span class="math display">\[
f(x;\lambda)=\lambda e^{-\lambda x},~~x\geq0
\]</span> 对于<span class="math inline">\(n\)</span>个样本<span class="math inline">\(x_1,x_2,...,x_n\)</span>,其似然函数为： <span class="math display">\[
L(\lambda)=\prod\limits_{i=1}\limits^n \lambda e^{-\lambda x_i}
\]</span> 取对数似然函数并对<span class="math inline">\(\lambda\)</span>求导，令导数为0，可以得到<span class="math inline">\(\lambda\)</span>的最大似然估计(MLE)： <span class="math display">\[
\hat{\lambda}=\frac{1}{\overline{x}}
\]</span> (2)计算偏差： <span class="math display">\[
Bias=\hat{\lambda}_{bootstrap}-\hat{\lambda}_{original}
\]</span> (3)计算标准误差： <span class="math display">\[
SE=\sqrt{\frac{1}{m-1}\sum\limits_{i=1}\limits^m(\hat{\lambda}_{i}-\hat{\lambda}_{bootstrap})^2}
\]</span> 其中<span class="math inline">\(m\)</span>是Bootstrap迭代次数,<span class="math inline">\(\hat{\lambda}_{bootstrap}\)</span>是 Bootstrap
样本的均值。</p>
<p><strong>R代码</strong>：</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="co"># 加载数据和库</span></span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<pre><code>## Warning: package &#39;boot&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="co"># 设置随机种子以便结果可重现</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a><span class="co"># 空调设备故障时间间隔数据</span></span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a><span class="co"># 计算 MLE（最大似然估计）</span></span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(data)</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE of lambda:&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MLE of lambda: 0.00925212</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="co"># 定义 Bootstrap 函数</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>bootstrap_function <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>  resample_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>  lambda_hat <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(resample_data)</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>  <span class="fu">return</span>(lambda_hat)</span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a>}</span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a><span class="co"># 设置 Bootstrap 迭代次数</span></span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a></span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a><span class="co"># 使用 boot 函数进行 Bootstrap</span></span>
<span id="cb70-12"><a href="#cb70-12" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, <span class="at">statistic =</span> bootstrap_function, <span class="at">R =</span> B)</span>
<span id="cb70-13"><a href="#cb70-13" tabindex="-1"></a></span>
<span id="cb70-14"><a href="#cb70-14" tabindex="-1"></a><span class="co"># 计算偏差和标准误差</span></span>
<span id="cb70-15"><a href="#cb70-15" tabindex="-1"></a>bootstrap_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_results<span class="sc">$</span>t)</span>
<span id="cb70-16"><a href="#cb70-16" tabindex="-1"></a>bias <span class="ot">&lt;-</span> bootstrap_mean <span class="sc">-</span> lambda_mle</span>
<span id="cb70-17"><a href="#cb70-17" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_results<span class="sc">$</span>t)</span>
<span id="cb70-18"><a href="#cb70-18" tabindex="-1"></a></span>
<span id="cb70-19"><a href="#cb70-19" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb70-20"><a href="#cb70-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap Bias:&quot;</span>, bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Bootstrap Bias: 0.001331418</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap Standard Error:&quot;</span>, se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Bootstrap Standard Error: 0.004203464</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="co"># 查看 Bootstrap 结果</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a><span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="st">&quot;basic&quot;</span>)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot_results, type = &quot;basic&quot;)
## 
## Intervals : 
## Level      Basic         
## 95%   (-0.0027,  0.0131 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>从以上结果可以看出<span class="math inline">\(\lambda\)</span>的最大似然估计值为0.00925212，自举法的估计值的偏差为0.001331418，标准差为0.004203464</p>
<p><strong>7.5</strong> Refer to Exercise 7.4. Compute 95% bootstrap
confidence intervals for the mean time between failures 1/λ by the
standard normal, basic, percentile, and BCa methods. Compare the
intervals and explain why they may differ.</p>
<p><strong>解题思路</strong>：</p>
<p>(1)分别用standard normal, basic, percentile, and BCa计算<span class="math inline">\(1/\lambda\)</span>的95% bootstrap 置信区间</p>
<p>(2)作比较</p>
<p><strong>R代码</strong>：</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="co"># 加载必要库</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a><span class="co"># 空调设备故障时间间隔数据</span></span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a><span class="co"># MLE of lambda (风险率)</span></span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(data)</span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>mean_failure_time <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> lambda_mle</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a><span class="co"># 定义 Bootstrap 函数，用于估计1/λ（故障时间的均值）</span></span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a>bootstrap_function <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a>  resample_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a>  lambda_hat <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(resample_data)</span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> lambda_hat)  <span class="co"># 返回故障时间的均值</span></span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a>}</span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a></span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a><span class="co"># 设置 Bootstrap 迭代次数</span></span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb76-20"><a href="#cb76-20" tabindex="-1"></a></span>
<span id="cb76-21"><a href="#cb76-21" tabindex="-1"></a><span class="co"># 使用 boot 函数进行 Bootstrap</span></span>
<span id="cb76-22"><a href="#cb76-22" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, <span class="at">statistic =</span> bootstrap_function, <span class="at">R =</span> B)</span>
<span id="cb76-23"><a href="#cb76-23" tabindex="-1"></a></span>
<span id="cb76-24"><a href="#cb76-24" tabindex="-1"></a><span class="co"># 计算标准正态法置信区间</span></span>
<span id="cb76-25"><a href="#cb76-25" tabindex="-1"></a>z_star <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb76-26"><a href="#cb76-26" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_results<span class="sc">$</span>t)</span>
<span id="cb76-27"><a href="#cb76-27" tabindex="-1"></a>ci_standard_normal <span class="ot">&lt;-</span> <span class="fu">c</span>(mean_failure_time <span class="sc">-</span> z_star <span class="sc">*</span> se, mean_failure_time <span class="sc">+</span> z_star <span class="sc">*</span> se)</span>
<span id="cb76-28"><a href="#cb76-28" tabindex="-1"></a></span>
<span id="cb76-29"><a href="#cb76-29" tabindex="-1"></a><span class="co"># 计算基础法置信区间</span></span>
<span id="cb76-30"><a href="#cb76-30" tabindex="-1"></a>ci_basic <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="st">&quot;basic&quot;</span>)</span>
<span id="cb76-31"><a href="#cb76-31" tabindex="-1"></a></span>
<span id="cb76-32"><a href="#cb76-32" tabindex="-1"></a><span class="co"># 计算百分位法置信区间</span></span>
<span id="cb76-33"><a href="#cb76-33" tabindex="-1"></a>ci_percentile <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb76-34"><a href="#cb76-34" tabindex="-1"></a></span>
<span id="cb76-35"><a href="#cb76-35" tabindex="-1"></a><span class="co"># 计算 BCa 法置信区间</span></span>
<span id="cb76-36"><a href="#cb76-36" tabindex="-1"></a>ci_bca <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="st">&quot;bca&quot;</span>)</span>
<span id="cb76-37"><a href="#cb76-37" tabindex="-1"></a></span>
<span id="cb76-38"><a href="#cb76-38" tabindex="-1"></a><span class="co"># 输出所有置信区间</span></span>
<span id="cb76-39"><a href="#cb76-39" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Standard Normal CI: &quot;</span>, ci_standard_normal, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Standard Normal CI:  34.62818 181.5385</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Basic CI: &quot;</span>, ci_basic<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Basic CI:  28.02752 167.9979</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Percentile CI: &quot;</span>, ci_percentile<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Percentile CI:  48.16878 188.1391</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BCa CI: &quot;</span>, ci_bca<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## BCa CI:  58.5 218.7827</code></pre>
<p>从以上结果可以看出：Standard Normal
方法得到的置信区间为[34.62818,181.5385]，Basic
方法得到的置信区间为[28.02752,167.9979]，Percentile
方法得到的置信区间为[48.16878,188.1391], BCa
方法得到的置信区间为[58.5,218.7827]。这些方法得到的置信区间不同的可能原因：Standard
Normal
方法通常假设估计值是正态分布，因此当数据较少时可能会产生误差，且不一定能反映出偏态分布。Basic
方法和Percentile 方法都基于 Bootstrap
分布，前者对估计量进行校正，后者则直接使用经验分布。BCa
方法纠正了估计的偏差，并在估计量分布偏态时仍能提供有效的置信区间。BCa
方法和Percentile 方法适合在样本量较小且数据不对称时的情形，Standard
Normal 方法和Basic 方法更适合在数据接近正态分布或对称分布时的情形。</p>
<p><strong>HW5</strong></p>
<p><strong>7.8</strong> Refer to Exercise 7.7. Obtain the jackknife
estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><strong>解题思路</strong></p>
<p>（1）首先计算<span class="math inline">\(\theta\)</span>的估计值<span class="math inline">\(\hat{\theta}\)</span></p>
<p>（2）计算刀切估计的偏差</p>
<p>（3）计算刀切估计的标准差</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())    <span class="co"># 删除所有对象</span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a><span class="co"># 加载必要的库</span></span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a>data1<span class="ot">&lt;-</span><span class="fu">data</span>(scor)</span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a><span class="co"># 计算样本协方差矩阵</span></span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a>sample_cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" tabindex="-1"></a><span class="co"># 计算协方差矩阵的特征值</span></span>
<span id="cb84-10"><a href="#cb84-10" tabindex="-1"></a>eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sample_cov)<span class="sc">$</span>values</span>
<span id="cb84-11"><a href="#cb84-11" tabindex="-1"></a></span>
<span id="cb84-12"><a href="#cb84-12" tabindex="-1"></a><span class="co"># 计算 theta 的估计值</span></span>
<span id="cb84-13"><a href="#cb84-13" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> eigenvalues[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(eigenvalues)</span>
<span id="cb84-14"><a href="#cb84-14" tabindex="-1"></a></span>
<span id="cb84-15"><a href="#cb84-15" tabindex="-1"></a><span class="co"># Jackknife方法计算偏差和标准误差</span></span>
<span id="cb84-16"><a href="#cb84-16" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)  <span class="co"># 样本量</span></span>
<span id="cb84-17"><a href="#cb84-17" tabindex="-1"></a>theta_jackknife <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb84-18"><a href="#cb84-18" tabindex="-1"></a></span>
<span id="cb84-19"><a href="#cb84-19" tabindex="-1"></a><span class="co"># 对每个样本点，计算去掉该点后的 theta</span></span>
<span id="cb84-20"><a href="#cb84-20" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb84-21"><a href="#cb84-21" tabindex="-1"></a>  <span class="co"># 去掉第 i 个学生的数据</span></span>
<span id="cb84-22"><a href="#cb84-22" tabindex="-1"></a>  scor_jack <span class="ot">&lt;-</span> scor[<span class="sc">-</span>i, ]</span>
<span id="cb84-23"><a href="#cb84-23" tabindex="-1"></a>  <span class="co"># 计算新的协方差矩阵</span></span>
<span id="cb84-24"><a href="#cb84-24" tabindex="-1"></a>  cov_jack <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor_jack)</span>
<span id="cb84-25"><a href="#cb84-25" tabindex="-1"></a>  <span class="co"># 计算新的特征值</span></span>
<span id="cb84-26"><a href="#cb84-26" tabindex="-1"></a>  eigenvalues_jack <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cov_jack)<span class="sc">$</span>values</span>
<span id="cb84-27"><a href="#cb84-27" tabindex="-1"></a>  <span class="co"># 计算新的 theta</span></span>
<span id="cb84-28"><a href="#cb84-28" tabindex="-1"></a>  theta_jackknife[i] <span class="ot">&lt;-</span> eigenvalues_jack[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(eigenvalues_jack)</span>
<span id="cb84-29"><a href="#cb84-29" tabindex="-1"></a>}</span>
<span id="cb84-30"><a href="#cb84-30" tabindex="-1"></a></span>
<span id="cb84-31"><a href="#cb84-31" tabindex="-1"></a><span class="co"># 计算 Jackknife 偏差</span></span>
<span id="cb84-32"><a href="#cb84-32" tabindex="-1"></a>theta_mean_jack <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta_jackknife)</span>
<span id="cb84-33"><a href="#cb84-33" tabindex="-1"></a>jackknife_bias <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (theta_mean_jack <span class="sc">-</span> theta_hat)</span>
<span id="cb84-34"><a href="#cb84-34" tabindex="-1"></a></span>
<span id="cb84-35"><a href="#cb84-35" tabindex="-1"></a><span class="co"># 计算 Jackknife 标准误差</span></span>
<span id="cb84-36"><a href="#cb84-36" tabindex="-1"></a>jackknife_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">mean</span>((theta_jackknife <span class="sc">-</span> theta_mean_jack)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb84-37"><a href="#cb84-37" tabindex="-1"></a></span>
<span id="cb84-38"><a href="#cb84-38" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb84-39"><a href="#cb84-39" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Theta estimate (theta_hat):&quot;</span>, theta_hat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Theta estimate (theta_hat): 0.619115</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Jackknife Bias estimate:&quot;</span>, jackknife_bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Jackknife Bias estimate: 0.001069139</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Jackknife Standard Error estimate:&quot;</span>, jackknife_se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Jackknife Standard Error estimate: 0.04955231</code></pre>
<p>从输出结果可以看出，刀切估计量的偏差为0.001069139，标准差为0.04955231。</p>
<p><strong>7.10</strong> In Example 7.18, leave-one-out (n-fold) cross
validation was used to select the best fitting model. Repeat the
analysis replacing the Log-Log model with a cubic polynomial model.
Which of the four models is selected by the cross validation procedure?
Which model is selected according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
<p><strong>解题思路</strong></p>
<p>（1）将对数-对数模型替换为三次多项式模型</p>
<p>（2）用<span class="math inline">\(k\)</span>折交叉检验比较这四个模型</p>
<p>（3）比较四个模型的调整<span class="math inline">\(R^2\)</span></p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb90-7"><a href="#cb90-7" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb90-8"><a href="#cb90-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb90-9"><a href="#cb90-9" tabindex="-1"></a>x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb90-10"><a href="#cb90-10" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" tabindex="-1"></a>J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb90-12"><a href="#cb90-12" tabindex="-1"></a>yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb90-13"><a href="#cb90-13" tabindex="-1"></a>e1[k] <span class="ot">&lt;-</span> magnetic[k]<span class="sc">-</span> yhat1</span>
<span id="cb90-14"><a href="#cb90-14" tabindex="-1"></a></span>
<span id="cb90-15"><a href="#cb90-15" tabindex="-1"></a>J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb90-16"><a href="#cb90-16" tabindex="-1"></a>yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb90-17"><a href="#cb90-17" tabindex="-1"></a>J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb90-18"><a href="#cb90-18" tabindex="-1"></a>e2[k] <span class="ot">&lt;-</span> magnetic[k]<span class="sc">-</span> yhat2</span>
<span id="cb90-19"><a href="#cb90-19" tabindex="-1"></a></span>
<span id="cb90-20"><a href="#cb90-20" tabindex="-1"></a>J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb90-21"><a href="#cb90-21" tabindex="-1"></a>logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb90-22"><a href="#cb90-22" tabindex="-1"></a>yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb90-23"><a href="#cb90-23" tabindex="-1"></a>e3[k] <span class="ot">&lt;-</span> magnetic[k]<span class="sc">-</span> yhat3</span>
<span id="cb90-24"><a href="#cb90-24" tabindex="-1"></a></span>
<span id="cb90-25"><a href="#cb90-25" tabindex="-1"></a>J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb90-26"><a href="#cb90-26" tabindex="-1"></a>yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb90-27"><a href="#cb90-27" tabindex="-1"></a>J4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb90-28"><a href="#cb90-28" tabindex="-1"></a>e4[k] <span class="ot">&lt;-</span> magnetic[k]<span class="sc">-</span> yhat4</span>
<span id="cb90-29"><a href="#cb90-29" tabindex="-1"></a>}</span>
<span id="cb90-30"><a href="#cb90-30" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> magnetic</span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> chemical</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a>J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a>J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a><span class="fu">summary</span>(J1)<span class="sc">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.5281545</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="fu">summary</span>(J2)<span class="sc">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.5768151</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="fu">summary</span>(J3)<span class="sc">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.5280556</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="fu">summary</span>(J4)<span class="sc">$</span>adj.r.squared</span></code></pre></div>
<pre><code>## [1] 0.5740396</code></pre>
<p>从以上结果可以看出，线性模型、二次多项式模型、指数模型、三次多项式模型的均方误差分别为：19.55644、17.85248、18.44188、18.17756。均方误差最小的模型仍然为二次多项式模型。但从调整后的<span class="math inline">\(R^2\)</span>来看（这四个模型的调整<span class="math inline">\(R^2\)</span>分别为0.5281545、0.5768151、0.5280556、0.5740396），最好的模型仍为二次多项式模型。</p>
<p><strong>8.1</strong> Implement the two-sample Cram<span class="math inline">\(\acute{e}\)</span>r-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<p><strong>解题思路</strong></p>
<p>（1）构建Cramér-von Mises统计量</p>
<p>（2）进行置换检验</p>
<p>（3）分析检验结果的P值</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())    <span class="co"># 删除所有对象</span></span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a><span class="co"># 加载数据</span></span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a><span class="fu">data</span>(chickwts)</span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a></span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a><span class="co"># 提取soybean和linseed组的重量数据</span></span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a>sample.x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a>sample.y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb100-9"><a href="#cb100-9" tabindex="-1"></a></span>
<span id="cb100-10"><a href="#cb100-10" tabindex="-1"></a><span class="co"># 定义Cramér-von Mises统计量计算函数</span></span>
<span id="cb100-11"><a href="#cb100-11" tabindex="-1"></a>cvm_statistic <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb100-12"><a href="#cb100-12" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb100-13"><a href="#cb100-13" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb100-14"><a href="#cb100-14" tabindex="-1"></a>  <span class="co"># combined &lt;- c(x, y)</span></span>
<span id="cb100-15"><a href="#cb100-15" tabindex="-1"></a>  ecdf_x <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x)</span>
<span id="cb100-16"><a href="#cb100-16" tabindex="-1"></a>  ecdf_y <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(y)</span>
<span id="cb100-17"><a href="#cb100-17" tabindex="-1"></a>  </span>
<span id="cb100-18"><a href="#cb100-18" tabindex="-1"></a>  <span class="co"># 计算Cramér-von Mises统计量</span></span>
<span id="cb100-19"><a href="#cb100-19" tabindex="-1"></a>  cvm <span class="ot">&lt;-</span> (m<span class="sc">*</span>n)<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="fu">sum</span>((<span class="fu">ecdf_x</span>(x) <span class="sc">-</span> <span class="fu">ecdf_y</span>(x))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">sum</span>((<span class="fu">ecdf_x</span>(y) <span class="sc">-</span> <span class="fu">ecdf_y</span>(y))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb100-20"><a href="#cb100-20" tabindex="-1"></a>  <span class="fu">return</span>(cvm)</span>
<span id="cb100-21"><a href="#cb100-21" tabindex="-1"></a>}</span>
<span id="cb100-22"><a href="#cb100-22" tabindex="-1"></a></span>
<span id="cb100-23"><a href="#cb100-23" tabindex="-1"></a><span class="co"># 计算原始样本的Cramér-von Mises统计量</span></span>
<span id="cb100-24"><a href="#cb100-24" tabindex="-1"></a>original_cvm <span class="ot">&lt;-</span> <span class="fu">cvm_statistic</span>(sample.x, sample.y)</span>
<span id="cb100-25"><a href="#cb100-25" tabindex="-1"></a></span>
<span id="cb100-26"><a href="#cb100-26" tabindex="-1"></a><span class="co"># 定义置换检验次数</span></span>
<span id="cb100-27"><a href="#cb100-27" tabindex="-1"></a>n_permutations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb100-28"><a href="#cb100-28" tabindex="-1"></a>perm_cvm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_permutations)</span>
<span id="cb100-29"><a href="#cb100-29" tabindex="-1"></a></span>
<span id="cb100-30"><a href="#cb100-30" tabindex="-1"></a><span class="co"># 进行置换检验</span></span>
<span id="cb100-31"><a href="#cb100-31" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1213</span>)</span>
<span id="cb100-32"><a href="#cb100-32" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_permutations) {</span>
<span id="cb100-33"><a href="#cb100-33" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(sample.x, sample.y))</span>
<span id="cb100-34"><a href="#cb100-34" tabindex="-1"></a>  x_perm <span class="ot">&lt;-</span> combined[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sample.x)]</span>
<span id="cb100-35"><a href="#cb100-35" tabindex="-1"></a>  y_perm <span class="ot">&lt;-</span> combined[(<span class="fu">length</span>(sample.x) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(combined)]</span>
<span id="cb100-36"><a href="#cb100-36" tabindex="-1"></a>  </span>
<span id="cb100-37"><a href="#cb100-37" tabindex="-1"></a>  perm_cvm[i] <span class="ot">&lt;-</span> <span class="fu">cvm_statistic</span>(x_perm, y_perm)</span>
<span id="cb100-38"><a href="#cb100-38" tabindex="-1"></a>}</span>
<span id="cb100-39"><a href="#cb100-39" tabindex="-1"></a></span>
<span id="cb100-40"><a href="#cb100-40" tabindex="-1"></a><span class="co"># 计算p值</span></span>
<span id="cb100-41"><a href="#cb100-41" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(perm_cvm) <span class="sc">&gt;=</span> <span class="fu">abs</span>(original_cvm))</span>
<span id="cb100-42"><a href="#cb100-42" tabindex="-1"></a></span>
<span id="cb100-43"><a href="#cb100-43" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb100-44"><a href="#cb100-44" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;原始样本的Cramér-von Mises统计量:&quot;</span>, original_cvm, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 原始样本的Cramér-von Mises统计量: 0.1515216</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;置换检验的p值:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 置换检验的p值: 0.4138</code></pre>
<p>从输出结果可以看出，置换检验的P值为0.4138大于0.05，接受原假设，故在显著性水平为0.05下认为soybean
和 linseed groups的分布相同。</p>
<p><strong>8.2</strong> Implement the bivariate Spearman rank
correlation test for independence [255] as a permutation test. The
Spearman rank correlation test statistic can be obtained from function
cor with method = “spearman”. Compare the achieved significance level of
the permutation test with the p-value reported by cor.test on the same
samples.</p>
<p><strong>解题思路</strong></p>
<p>（1）计算斯皮尔曼秩相关检验的p 值</p>
<p>（2）进行置换检验</p>
<p>（3）分析检验结果的P值并进行对比</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="co"># 加载数据</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a><span class="fu">data</span>(chickwts)</span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a><span class="co"># 使用R介绍cor.test函数的样例数据</span></span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">44.4</span>, <span class="fl">45.9</span>, <span class="fl">41.9</span>, <span class="fl">53.3</span>, <span class="fl">44.7</span>, <span class="fl">44.1</span>, <span class="fl">50.7</span>, <span class="fl">45.2</span>, <span class="fl">60.1</span>)</span>
<span id="cb104-6"><a href="#cb104-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fl">2.6</span>,  <span class="fl">3.1</span>,  <span class="fl">2.5</span>,  <span class="fl">5.0</span>,  <span class="fl">3.6</span>,  <span class="fl">4.0</span>,  <span class="fl">5.2</span>,  <span class="fl">2.8</span>,  <span class="fl">3.8</span>)</span>
<span id="cb104-7"><a href="#cb104-7" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" tabindex="-1"></a></span>
<span id="cb104-9"><a href="#cb104-9" tabindex="-1"></a><span class="co"># 使用 cor.test 函数计算 Spearman 相关系数的 p 值</span></span>
<span id="cb104-10"><a href="#cb104-10" tabindex="-1"></a>spearman_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb104-11"><a href="#cb104-11" tabindex="-1"></a><span class="co">#cat(&quot;Spearman 相关系数:&quot;, spearman_result$estimate, &quot;\n&quot;)</span></span>
<span id="cb104-12"><a href="#cb104-12" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;cor.test 给出的 p 值:&quot;</span>, spearman_result<span class="sc">$</span>p.value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## cor.test 给出的 p 值: 0.09679784</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="co"># 定义 Spearman 相关系数计算函数</span></span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>spearman_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a>  <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb106-4"><a href="#cb106-4" tabindex="-1"></a>}</span>
<span id="cb106-5"><a href="#cb106-5" tabindex="-1"></a></span>
<span id="cb106-6"><a href="#cb106-6" tabindex="-1"></a><span class="co"># 计算原始样本的 Spearman 相关系数</span></span>
<span id="cb106-7"><a href="#cb106-7" tabindex="-1"></a>original_spearman <span class="ot">&lt;-</span> <span class="fu">spearman_stat</span>(x, y)</span>
<span id="cb106-8"><a href="#cb106-8" tabindex="-1"></a></span>
<span id="cb106-9"><a href="#cb106-9" tabindex="-1"></a><span class="co"># 定义置换检验的次数</span></span>
<span id="cb106-10"><a href="#cb106-10" tabindex="-1"></a>n_permutations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb106-11"><a href="#cb106-11" tabindex="-1"></a>perm_spearman <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_permutations)</span>
<span id="cb106-12"><a href="#cb106-12" tabindex="-1"></a></span>
<span id="cb106-13"><a href="#cb106-13" tabindex="-1"></a><span class="co"># 进行置换检验</span></span>
<span id="cb106-14"><a href="#cb106-14" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)</span>
<span id="cb106-15"><a href="#cb106-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_permutations) {</span>
<span id="cb106-16"><a href="#cb106-16" tabindex="-1"></a>  y_perm <span class="ot">&lt;-</span> <span class="fu">sample</span>(y)  <span class="co"># 随机打乱 y 的顺序</span></span>
<span id="cb106-17"><a href="#cb106-17" tabindex="-1"></a>  perm_spearman[i] <span class="ot">&lt;-</span> <span class="fu">spearman_stat</span>(x, y_perm)</span>
<span id="cb106-18"><a href="#cb106-18" tabindex="-1"></a>}</span>
<span id="cb106-19"><a href="#cb106-19" tabindex="-1"></a></span>
<span id="cb106-20"><a href="#cb106-20" tabindex="-1"></a><span class="co"># 计算置换检验的 p 值</span></span>
<span id="cb106-21"><a href="#cb106-21" tabindex="-1"></a>p_value_permutation <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(perm_spearman) <span class="sc">&gt;=</span> <span class="fu">abs</span>(original_spearman))</span>
<span id="cb106-22"><a href="#cb106-22" tabindex="-1"></a></span>
<span id="cb106-23"><a href="#cb106-23" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb106-24"><a href="#cb106-24" tabindex="-1"></a><span class="co">#cat(&quot;原始样本的 Spearman 相关系数:&quot;, original_spearman, &quot;\n&quot;)</span></span>
<span id="cb106-25"><a href="#cb106-25" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;置换检验的 p 值:&quot;</span>, p_value_permutation, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 置换检验的 p 值: 0.0956</code></pre>
<p>从以上结果可以得到斯皮尔曼秩相关检验的 p 值为0.0968，与置换检验的 P
,0.0956较为接近。</p>
<p><strong>HW6</strong></p>
<p><strong>9.3</strong> Use the Metropolis-Hastings sampler to generate
random variables from a standard Cauchy distribution. Discard the first
1000 of the chain, and compare the deciles of the generated observations
with the deciles of the standard Cauchy distribution (see qcauchyor qt
with df=1). Recall that a Cauchy(<span class="math inline">\(θ,η\)</span>) distribution has density function
<span class="math display">\[
f(x)=\frac{1}{\theta
\pi(1+[(x-\eta)/\theta]^2)},  -\infty&lt;x&lt;\infty, \theta&gt;0.
\]</span> The standard Cauchy has the Cauchy(<span class="math inline">\(θ =1,η= 0\)</span>) density. (Note that the
standard Cauchy density is equal to the Student t density with one
degree of freedom.)</p>
<p><strong>解题思路</strong></p>
<p>(1)使用Metropolis-Hastings采样器从柯西分布中生成随机变量</p>
<p>(2)丢弃链中的前1000个随机变量</p>
<p>(3)比较生成的观测值与标准柯西分布的十分位数</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1213</span>)  <span class="co"># 固定随机种子</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a><span class="co"># Metropolis-Hastings采样器</span></span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a>metropolis_cauchy <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">burn_in =</span> <span class="dv">1000</span>) {</span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a>  <span class="co"># 初始值</span></span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n <span class="sc">+</span> burn_in)</span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a>  </span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n <span class="sc">+</span> burn_in)) {</span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a>    <span class="co"># 从提议分布N(x[i-1], 1)采样候选点</span></span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a>    proposal <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> x[i <span class="sc">-</span> <span class="dv">1</span>], <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb108-12"><a href="#cb108-12" tabindex="-1"></a>    </span>
<span id="cb108-13"><a href="#cb108-13" tabindex="-1"></a>    <span class="co"># 计算接受概率</span></span>
<span id="cb108-14"><a href="#cb108-14" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(proposal) <span class="sc">/</span> <span class="fu">dcauchy</span>(x[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb108-15"><a href="#cb108-15" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> alpha) {</span>
<span id="cb108-16"><a href="#cb108-16" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> proposal</span>
<span id="cb108-17"><a href="#cb108-17" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb108-18"><a href="#cb108-18" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb108-19"><a href="#cb108-19" tabindex="-1"></a>    }</span>
<span id="cb108-20"><a href="#cb108-20" tabindex="-1"></a>  }</span>
<span id="cb108-21"><a href="#cb108-21" tabindex="-1"></a>  </span>
<span id="cb108-22"><a href="#cb108-22" tabindex="-1"></a>  <span class="co"># 丢弃前burn_in个样本</span></span>
<span id="cb108-23"><a href="#cb108-23" tabindex="-1"></a>  <span class="fu">return</span>(x[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n <span class="sc">+</span> burn_in)])</span>
<span id="cb108-24"><a href="#cb108-24" tabindex="-1"></a>}</span>
<span id="cb108-25"><a href="#cb108-25" tabindex="-1"></a></span>
<span id="cb108-26"><a href="#cb108-26" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb108-27"><a href="#cb108-27" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 所需样本数量</span></span>
<span id="cb108-28"><a href="#cb108-28" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">metropolis_cauchy</span>(n)</span>
<span id="cb108-29"><a href="#cb108-29" tabindex="-1"></a></span>
<span id="cb108-30"><a href="#cb108-30" tabindex="-1"></a><span class="co"># 计算生成样本的分位数</span></span>
<span id="cb108-31"><a href="#cb108-31" tabindex="-1"></a>sample_deciles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb108-32"><a href="#cb108-32" tabindex="-1"></a></span>
<span id="cb108-33"><a href="#cb108-33" tabindex="-1"></a><span class="co"># 计算标准柯西分布的理论分位数</span></span>
<span id="cb108-34"><a href="#cb108-34" tabindex="-1"></a>theoretical_deciles <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb108-35"><a href="#cb108-35" tabindex="-1"></a></span>
<span id="cb108-36"><a href="#cb108-36" tabindex="-1"></a><span class="co"># 比较生成样本分位数与理论分位数</span></span>
<span id="cb108-37"><a href="#cb108-37" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb108-38"><a href="#cb108-38" tabindex="-1"></a>  <span class="at">Decile =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb108-39"><a href="#cb108-39" tabindex="-1"></a>  <span class="at">Simulated =</span> sample_deciles,</span>
<span id="cb108-40"><a href="#cb108-40" tabindex="-1"></a>  <span class="at">Theoretical =</span> theoretical_deciles</span>
<span id="cb108-41"><a href="#cb108-41" tabindex="-1"></a>)</span>
<span id="cb108-42"><a href="#cb108-42" tabindex="-1"></a></span>
<span id="cb108-43"><a href="#cb108-43" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##      Decile   Simulated Theoretical
## 10%     0.1 -2.87041487  -3.0776835
## 20%     0.2 -1.34311021  -1.3763819
## 30%     0.3 -0.70368683  -0.7265425
## 40%     0.4 -0.32288951  -0.3249197
## 50%     0.5 -0.02793981   0.0000000
## 60%     0.6  0.27678234   0.3249197
## 70%     0.7  0.67939946   0.7265425
## 80%     0.8  1.24253499   1.3763819
## 90%     0.9  2.76819174   3.0776835
## 100%    1.0 17.64335779         Inf</code></pre>
<p>从输出结果可以看出，生成的观测值的十分位数与标准柯西分布的十分位数较为接近。</p>
<p><strong>9.8</strong> This example appears in [40]. Consider the
bivariate density <span class="math display">\[
f(x,y)\propto \binom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},~~x=0,1,...,n,~0\leq
y\leq 1.
\]</span> It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a,b,n\)</span>, the conditional distributions are
Binomial(<span class="math inline">\(n,y\)</span>) and Beta(<span class="math inline">\(x+a,n−x+b\)</span>). Use the Gibbs sampler to
generate a chain with target joint density <span class="math inline">\(f(x,y)\)</span>.</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)  <span class="co"># 固定随机种子</span></span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a><span class="co"># Gibbs采样器函数</span></span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a>gibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, n, num_samples) {</span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a>  <span class="co"># 初始化链</span></span>
<span id="cb110-6"><a href="#cb110-6" tabindex="-1"></a>  x_chain <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb110-7"><a href="#cb110-7" tabindex="-1"></a>  y_chain <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb110-8"><a href="#cb110-8" tabindex="-1"></a>  </span>
<span id="cb110-9"><a href="#cb110-9" tabindex="-1"></a>  <span class="co"># 初始值</span></span>
<span id="cb110-10"><a href="#cb110-10" tabindex="-1"></a>  x_chain[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb110-11"><a href="#cb110-11" tabindex="-1"></a>  y_chain[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb110-12"><a href="#cb110-12" tabindex="-1"></a>  </span>
<span id="cb110-13"><a href="#cb110-13" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_samples) {</span>
<span id="cb110-14"><a href="#cb110-14" tabindex="-1"></a>    <span class="co"># 给定当前y，采样x | y ~ Binomial(n, y)</span></span>
<span id="cb110-15"><a href="#cb110-15" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y_chain[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb110-16"><a href="#cb110-16" tabindex="-1"></a>    x_chain[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb110-17"><a href="#cb110-17" tabindex="-1"></a>    </span>
<span id="cb110-18"><a href="#cb110-18" tabindex="-1"></a>    <span class="co"># 给定当前x，采样y | x ~ Beta(x + a, n - x + b)</span></span>
<span id="cb110-19"><a href="#cb110-19" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x_chain[i]</span>
<span id="cb110-20"><a href="#cb110-20" tabindex="-1"></a>    y_chain[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb110-21"><a href="#cb110-21" tabindex="-1"></a>  }</span>
<span id="cb110-22"><a href="#cb110-22" tabindex="-1"></a>  </span>
<span id="cb110-23"><a href="#cb110-23" tabindex="-1"></a>  <span class="co"># 返回生成的链</span></span>
<span id="cb110-24"><a href="#cb110-24" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> x_chain, <span class="at">y =</span> y_chain))</span>
<span id="cb110-25"><a href="#cb110-25" tabindex="-1"></a>}</span>
<span id="cb110-26"><a href="#cb110-26" tabindex="-1"></a></span>
<span id="cb110-27"><a href="#cb110-27" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb110-28"><a href="#cb110-28" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb110-29"><a href="#cb110-29" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb110-30"><a href="#cb110-30" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb110-31"><a href="#cb110-31" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb110-32"><a href="#cb110-32" tabindex="-1"></a></span>
<span id="cb110-33"><a href="#cb110-33" tabindex="-1"></a><span class="co"># 运行Gibbs采样器</span></span>
<span id="cb110-34"><a href="#cb110-34" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(a, b, n, num_samples)</span>
<span id="cb110-35"><a href="#cb110-35" tabindex="-1"></a></span>
<span id="cb110-36"><a href="#cb110-36" tabindex="-1"></a><span class="co"># 丢弃前1000个样本</span></span>
<span id="cb110-37"><a href="#cb110-37" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb110-38"><a href="#cb110-38" tabindex="-1"></a>samples <span class="ot">&lt;-</span> samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in), ]</span>
<span id="cb110-39"><a href="#cb110-39" tabindex="-1"></a></span>
<span id="cb110-40"><a href="#cb110-40" tabindex="-1"></a><span class="co"># 显示前几组生成的样本</span></span>
<span id="cb110-41"><a href="#cb110-41" tabindex="-1"></a><span class="fu">head</span>(samples)</span></code></pre></div>
<pre><code>##       x         y
## 1001 10 0.9595620
## 1002 10 0.9164757
## 1003 10 0.9855175
## 1004 10 0.9840960
## 1005  9 0.5906175
## 1006  2 0.4786205</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="fu">plot</span>(samples<span class="sc">$</span>x,<span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmOpBmZmZmtrZmtttmtv+QOgCQOmaQZgCQkGaQ2/+2ZgC2/7a2///bkDrb2//b/9vb////tmb/25D//7b//9v///8kB5wMAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHGElEQVR4nO2di3ajNhRFmTROG08fcduhoQ2x+f+fLJIAYww+MohEEXuvtovY4mLtopd9gayCm2Sf/QFiB0ECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQAEECBAkQJECQILCg7MvwWYLChlsPBAkQJPhgQYOmPdnuvV+8fH+siFd3N37ATxA0DHfX59WVRJCoJIJEJREkKokgUUkEzagngkQRBIkiCBJFECSKJCkoDhAkQJBgpqDTvwi6Kei43zlRf74iaExQVWbfflRVkT0gaFxQdTqY3Z8X6ElckDX0crN0nmU763GqWNKC6tr/ccge36YLF/WbebYzHdbEiZawoOPetq7yRh90OtQlStNTWVVbE/Srq/KNUey4r1tWaQWWlxoHR09SkAebPoNyU+Miu91Ld32QVbUpQYU5L8zJ8f50y9BmRzE7jT4dzFw6vzWMeYZLT1B+EWHBXDFVQXZe47pfzqDRGuUPr66FlcvWGskKMo3MjWOsxcYFBQJBGxZkOuoiu7lY3bagevh6f9pV+Q5Bo4LMSrSsZ8gl3yhOC6oH+6pA0Ligum0d949v7Xf3CLoSdNxn33642SKCxgQFAUFbFlS3sce3nKXGlKB6MV+YTprF6rgg8y2q+Up11jA/OHqSgsw8yAhiojghqD2D+MJsQlDTBxXix+cNCzKjWGYzPBA0LigECEIQgsZqZLufBob5sRqFAkFbFmTb2bLv7JMW1CT+LJsIJSzodHBTaJYaE4KO392pw2J1QlB7Bk0l121ekP1RzGQvsFgdF3THXPFGml7CgjzwcLhtQW121UbPoPb8uNW+zG+vY4IGR09S0OngNXzlt1OFe4KqzPPK28UVvrPETEH2OgMPiux5m4Imk+eHvD/9tElB1fvPnquw02F6rpS0oCe3f6ilRmqClia+JC/It5PerCDvTnqrgvw76Y0K6hZadNLjgsKAIE9B5p+LT3axPhuvkikyfKcXpBqU60r3QlfDfXtbVVtwriCfxeqmBeWPb8VOXLO6ZUEmObE0KXhBvpNOUtBL9f7Lq/03kKAqKUFmomh++lld0IiGLyHIprfmzyGbWGKCzJVi9Ui2aBBLW1AIEDQRpVfLZAUFvWbVCao6Ra1E906zFqkuFbiK93Q0Eaqse+N8lKx9/fzH+YXuQO3xmgjVxf/CewUFvWY1QUFhr1lNVFC4a1YTFBT2mtUUBQW9ZjVFQUFAkF84BIlwCBLhEKTDXW1l7Vbz3+yi2GXx7Fyg/+LVh+0MDgK4fXvv9gMPjuddoyAgyDscgkQ4BIlwCBLhtinI3dX9xo+LGxfU3WVx8naU2xbUSyES95Me29qAoF4Smrgj+fADt5+793eKgu46gyJnrT6oOYU8+qDIWWkUa1NkJn/62Lqgjw63Hp8m6MvwSYK8g8ZUZNX95waNqciq+88NGlORVfefGzSmIqvuPzdoTEVW3X9u0JiKrLr/3KAxFVl1/7lBYyqy6v5zg8ZUZNX9kwdBAgQJECRAkABBAgQJECRAkABBAgQJECRAkCC8oDKb/+QAdyPZLsL1hqZ7XvWiKGeCCzI3FS5nGirtT7ZdhOsNjbmbsb2n6KIoPUILcgkO8y46s09fOke43vA5/G5q55mfLLQgd+eGeddUFY9/1YK6CNcbOkQnaFGUPsEF2bsQzboqr97V9EFdhOsNjyBtE1sWpUdoQa6Rz+mETBMwgroI1xteHyDL2g5nQZQz8Qhqn7y0rGrmosn3p+d4Bc1uYnbHxU3s3OPE2sRmd9JFk5bysqh77U6TaDvpJcO8O4MWDdDOQn2aRDvML5ooupn0oile2wdFO1G0bWXhUqOLcL3hEaJups/jO8/6ZCxWBQgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEgQn6Cr/ILZqRBBQJAAQYIoBR33v+9dvrzJWPnbCCpcVotJEDNPSPk4IhVUOzEJvSYdqsyaP0xelEkTW/b8qnuJVNCzzaZzCXV584JNwCwf/vn+oS0uUkEv9raWLiW1S+G1vvIsxDOp/YlaUNEJalNgK3elygcStaDBGWQ4HX5b9oi4e4laUJPa3LxgKR7/C/LUbm+iFtRcmtKMYq63Xvr8qnuJW9DlPMg8pdJmmn9kNx2foMhAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJ/ge2jwVPZ/m8egAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="fu">plot</span>(samples<span class="sc">$</span>y,<span class="at">type=</span><span class="st">&#39;l&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="fu">hist</span>(samples<span class="sc">$</span>x)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="fu">hist</span>(samples<span class="sc">$</span>y)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For each of the above exercise, use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt;1.2\)</span>.</p>
<p><strong>解题思路</strong></p>
<p>(1)使用Gelman-Rubin方法监控链的收敛性</p>
<p>(2)当<span class="math inline">\(\hat{R}
&lt;1.2\)</span>时，说明链已收敛到目标分布</p>
<p>9.3 <strong>R代码</strong></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)  <span class="co"># 固定随机种子</span></span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a><span class="co"># Metropolis-Hastings 采样器函数</span></span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a>metropolis_cauchy <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">burn_in =</span> <span class="dv">1000</span>, <span class="at">init =</span> <span class="dv">0</span>) {</span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n <span class="sc">+</span> burn_in)</span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> init</span>
<span id="cb116-7"><a href="#cb116-7" tabindex="-1"></a>  </span>
<span id="cb116-8"><a href="#cb116-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n <span class="sc">+</span> burn_in)) {</span>
<span id="cb116-9"><a href="#cb116-9" tabindex="-1"></a>    proposal <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> x[i <span class="sc">-</span> <span class="dv">1</span>], <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb116-10"><a href="#cb116-10" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(proposal) <span class="sc">/</span> <span class="fu">dcauchy</span>(x[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb116-11"><a href="#cb116-11" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> alpha) {</span>
<span id="cb116-12"><a href="#cb116-12" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> proposal</span>
<span id="cb116-13"><a href="#cb116-13" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb116-14"><a href="#cb116-14" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb116-15"><a href="#cb116-15" tabindex="-1"></a>    }</span>
<span id="cb116-16"><a href="#cb116-16" tabindex="-1"></a>  }</span>
<span id="cb116-17"><a href="#cb116-17" tabindex="-1"></a>  <span class="fu">return</span>(x[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n <span class="sc">+</span> burn_in)])</span>
<span id="cb116-18"><a href="#cb116-18" tabindex="-1"></a>}</span>
<span id="cb116-19"><a href="#cb116-19" tabindex="-1"></a></span>
<span id="cb116-20"><a href="#cb116-20" tabindex="-1"></a><span class="co"># 多条链的 Metropolis-Hastings 采样</span></span>
<span id="cb116-21"><a href="#cb116-21" tabindex="-1"></a>num_chains <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb116-22"><a href="#cb116-22" tabindex="-1"></a>chain_length <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb116-23"><a href="#cb116-23" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>num_chains, <span class="cf">function</span>(i) <span class="fu">metropolis_cauchy</span>(chain_length, <span class="at">init =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>)))</span>
<span id="cb116-24"><a href="#cb116-24" tabindex="-1"></a></span>
<span id="cb116-25"><a href="#cb116-25" tabindex="-1"></a><span class="co"># 将结果转换为 mcmc 列表</span></span>
<span id="cb116-26"><a href="#cb116-26" tabindex="-1"></a>mh_mcmc <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">lapply</span>(chains, mcmc))</span>
<span id="cb116-27"><a href="#cb116-27" tabindex="-1"></a></span>
<span id="cb116-28"><a href="#cb116-28" tabindex="-1"></a><span class="co"># 计算 Gelman-Rubin 诊断</span></span>
<span id="cb116-29"><a href="#cb116-29" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">gelman.diag</span>(mh_mcmc)<span class="sc">$</span>psrf[, <span class="st">&quot;Point est.&quot;</span>])</span></code></pre></div>
<pre><code>## Point est. 
##   1.127759</code></pre>
<p>从输出结果可以看出，<span class="math inline">\(\hat{R}
=1.13&lt;1.2\)</span>，说明链已收敛到目标分布。</p>
<p>9.8 <strong>R代码</strong></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)  <span class="co"># 固定随机种子</span></span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a><span class="co"># Gibbs 采样器函数</span></span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>gibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, n, num_samples, <span class="at">init_x =</span> <span class="dv">0</span>, <span class="at">init_y =</span> <span class="fl">0.5</span>) {</span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>  x_chain <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb118-5"><a href="#cb118-5" tabindex="-1"></a>  y_chain <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb118-6"><a href="#cb118-6" tabindex="-1"></a>  x_chain[<span class="dv">1</span>] <span class="ot">&lt;-</span> init_x</span>
<span id="cb118-7"><a href="#cb118-7" tabindex="-1"></a>  y_chain[<span class="dv">1</span>] <span class="ot">&lt;-</span> init_y</span>
<span id="cb118-8"><a href="#cb118-8" tabindex="-1"></a>  </span>
<span id="cb118-9"><a href="#cb118-9" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_samples) {</span>
<span id="cb118-10"><a href="#cb118-10" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y_chain[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb118-11"><a href="#cb118-11" tabindex="-1"></a>    x_chain[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb118-12"><a href="#cb118-12" tabindex="-1"></a>    </span>
<span id="cb118-13"><a href="#cb118-13" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x_chain[i]</span>
<span id="cb118-14"><a href="#cb118-14" tabindex="-1"></a>    y_chain[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb118-15"><a href="#cb118-15" tabindex="-1"></a>  }</span>
<span id="cb118-16"><a href="#cb118-16" tabindex="-1"></a>  </span>
<span id="cb118-17"><a href="#cb118-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> x_chain, <span class="at">y =</span> y_chain))</span>
<span id="cb118-18"><a href="#cb118-18" tabindex="-1"></a>}</span>
<span id="cb118-19"><a href="#cb118-19" tabindex="-1"></a></span>
<span id="cb118-20"><a href="#cb118-20" tabindex="-1"></a><span class="co"># 设置参数和链数量</span></span>
<span id="cb118-21"><a href="#cb118-21" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb118-22"><a href="#cb118-22" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb118-23"><a href="#cb118-23" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb118-24"><a href="#cb118-24" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb118-25"><a href="#cb118-25" tabindex="-1"></a>num_chains <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb118-26"><a href="#cb118-26" tabindex="-1"></a></span>
<span id="cb118-27"><a href="#cb118-27" tabindex="-1"></a><span class="co"># 运行多条 Gibbs 采样链</span></span>
<span id="cb118-28"><a href="#cb118-28" tabindex="-1"></a>gibbs_chains <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>num_chains, <span class="cf">function</span>(i) <span class="fu">gibbs_sampler</span>(a, b, n, num_samples, <span class="at">init_x =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>n, <span class="dv">1</span>), <span class="at">init_y =</span> <span class="fu">runif</span>(<span class="dv">1</span>)))</span>
<span id="cb118-29"><a href="#cb118-29" tabindex="-1"></a></span>
<span id="cb118-30"><a href="#cb118-30" tabindex="-1"></a><span class="co"># 提取 x 和 y 链，计算 Gelman-Rubin 诊断</span></span>
<span id="cb118-31"><a href="#cb118-31" tabindex="-1"></a>x_chains <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">lapply</span>(gibbs_chains, <span class="cf">function</span>(chain) <span class="fu">mcmc</span>(chain<span class="sc">$</span>x)))</span>
<span id="cb118-32"><a href="#cb118-32" tabindex="-1"></a>y_chains <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">lapply</span>(gibbs_chains, <span class="cf">function</span>(chain) <span class="fu">mcmc</span>(chain<span class="sc">$</span>y)))</span>
<span id="cb118-33"><a href="#cb118-33" tabindex="-1"></a></span>
<span id="cb118-34"><a href="#cb118-34" tabindex="-1"></a><span class="co"># 计算 x 和 y 的 Gelman-Rubin 诊断</span></span>
<span id="cb118-35"><a href="#cb118-35" tabindex="-1"></a>gelman_diag_x <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(x_chains)</span>
<span id="cb118-36"><a href="#cb118-36" tabindex="-1"></a>gelman_diag_y <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(y_chains)</span>
<span id="cb118-37"><a href="#cb118-37" tabindex="-1"></a></span>
<span id="cb118-38"><a href="#cb118-38" tabindex="-1"></a><span class="fu">print</span>(gelman_diag_x<span class="sc">$</span>psrf[, <span class="st">&quot;Point est.&quot;</span>])</span></code></pre></div>
<pre><code>## Point est. 
##   1.000087</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="fu">print</span>(gelman_diag_y<span class="sc">$</span>psrf[, <span class="st">&quot;Point est.&quot;</span>])</span></code></pre></div>
<pre><code>## Point est. 
##   1.000096</code></pre>
<p>从输出结果可以看出，<span class="math inline">\(\hat{R_x}
=1&lt;1.2,\hat{R_y} =1&lt;1.2\)</span>，说明链已收敛到目标分布。</p>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
<p>若 <span class="math inline">\(s=r\)</span>，<span class="math inline">\(K(s,r)f(s) = K(r,s)f(r)\)</span>显然成立； 若
<span class="math inline">\(s\ne r\)</span>，根据条件有<span class="math inline">\(K(r,s)=\alpha(r,s)g(s|r),\alpha(s,r)=\min\{\frac{f((r)g(s|r)}{f(s)g(r|s)},1\}\)</span>，则
<span class="math display">\[
K(r,s)f(r)=\alpha(r,s)g(s|r)f(r)=\begin{cases} f(s)g(r|s) &amp;
f(s)g(r|s)\le f(r)g(s|r)\\ f(r)g(s|r) &amp; f(s)g(r|s)&gt; f(r)g(s|r)
\end{cases}
\]</span> 同理可得</p>
<p><span class="math display">\[
K(s,r)f(s)=\begin{cases} f(r)g(s|r) &amp; f(r)g(s|r)&lt;f(s)g(r|s)\\
f(s)g(r|s) &amp; f(r)g(s|r)\ge f(s)g(r|s) \end{cases}
\]</span></p>
<p>此时，显然有 <span class="math inline">\(K(s,r)f(s) =
K(r,s)f(r)\)</span>。</p>
<p><strong>HW7</strong></p>
<p><strong>11.3</strong> (a) Write a function to compute the <span class="math inline">\(k^{th}\)</span> term in <span class="math display">\[
\sum\limits_{k=0}^{\infty}\frac{(-1)^k}{k!2^k}\frac{||a||^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{\Gamma(k+\frac{d}{2}+1)},
\]</span> where <span class="math inline">\(d ≥ 1\)</span> is an
integer, <span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(\mathbb{R}^d\)</span>,and <span class="math inline">\(||·||\)</span> denotes the Euclidean norm. Perform
the arithmetic so that the coefficients can be computed for (almost)
arbitrarily large <span class="math inline">\(k\)</span> and <span class="math inline">\(d\)</span>. (This sum converges for all <span class="math inline">\(a \in \mathbb{R}^d\)</span>). (b) Modify the
function so that it computes and returns the sum. (c) Evaluate the sum
when <span class="math inline">\(a =(1,2)^T\)</span>.</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="co"># 定义函数计算向量的欧几里得范数</span></span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a>euclidean_norm <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb122-3"><a href="#cb122-3" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb122-4"><a href="#cb122-4" tabindex="-1"></a>}</span>
<span id="cb122-5"><a href="#cb122-5" tabindex="-1"></a></span>
<span id="cb122-6"><a href="#cb122-6" tabindex="-1"></a><span class="co"># 定义第 k 项的计算函数</span></span>
<span id="cb122-7"><a href="#cb122-7" tabindex="-1"></a>k_term <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a, d) {</span>
<span id="cb122-8"><a href="#cb122-8" tabindex="-1"></a>  norm_a <span class="ot">&lt;-</span> <span class="fu">euclidean_norm</span>(a)</span>
<span id="cb122-9"><a href="#cb122-9" tabindex="-1"></a>  coef1 <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">/</span> (<span class="fu">factorial</span>(k) <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>k)</span>
<span id="cb122-10"><a href="#cb122-10" tabindex="-1"></a>  coef2 <span class="ot">&lt;-</span> norm_a<span class="sc">^</span>(<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">/</span> ((<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>))</span>
<span id="cb122-11"><a href="#cb122-11" tabindex="-1"></a>  gamma_part <span class="ot">&lt;-</span> <span class="fu">gamma</span>((d <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">+</span> <span class="dv">3</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">gamma</span>(k <span class="sc">+</span> d <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb122-12"><a href="#cb122-12" tabindex="-1"></a>  term_k <span class="ot">&lt;-</span> coef1 <span class="sc">*</span> coef2 <span class="sc">*</span> gamma_part</span>
<span id="cb122-13"><a href="#cb122-13" tabindex="-1"></a>  <span class="fu">return</span>(term_k)</span>
<span id="cb122-14"><a href="#cb122-14" tabindex="-1"></a>}</span>
<span id="cb122-15"><a href="#cb122-15" tabindex="-1"></a></span>
<span id="cb122-16"><a href="#cb122-16" tabindex="-1"></a><span class="co"># 定义计算级数和的函数</span></span>
<span id="cb122-17"><a href="#cb122-17" tabindex="-1"></a>series_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(a, d, <span class="at">tol =</span> <span class="fl">1e-10</span>, <span class="at">max_iter =</span> <span class="dv">1000</span>) {</span>
<span id="cb122-18"><a href="#cb122-18" tabindex="-1"></a>  sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb122-19"><a href="#cb122-19" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb122-20"><a href="#cb122-20" tabindex="-1"></a>  <span class="cf">repeat</span> {</span>
<span id="cb122-21"><a href="#cb122-21" tabindex="-1"></a>    term <span class="ot">&lt;-</span> <span class="fu">k_term</span>(k, a, d)</span>
<span id="cb122-22"><a href="#cb122-22" tabindex="-1"></a>    sum <span class="ot">&lt;-</span> sum <span class="sc">+</span> term</span>
<span id="cb122-23"><a href="#cb122-23" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(term) <span class="sc">&lt;</span> tol) { <span class="co"># 收敛判断</span></span>
<span id="cb122-24"><a href="#cb122-24" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb122-25"><a href="#cb122-25" tabindex="-1"></a>    }</span>
<span id="cb122-26"><a href="#cb122-26" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb122-27"><a href="#cb122-27" tabindex="-1"></a>  }</span>
<span id="cb122-28"><a href="#cb122-28" tabindex="-1"></a>  <span class="fu">return</span>(sum)</span>
<span id="cb122-29"><a href="#cb122-29" tabindex="-1"></a>}</span>
<span id="cb122-30"><a href="#cb122-30" tabindex="-1"></a></span>
<span id="cb122-31"><a href="#cb122-31" tabindex="-1"></a><span class="co"># 计算当 a = (1, 2)^T, d = 2 时的级数和</span></span>
<span id="cb122-32"><a href="#cb122-32" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb122-33"><a href="#cb122-33" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb122-34"><a href="#cb122-34" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">series_sum</span>(a, d)</span>
<span id="cb122-35"><a href="#cb122-35" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;当 a = (1, 2)^T, d = 2 时的级数和为:&quot;</span>, result, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 当 a = (1, 2)^T, d = 2 时的级数和为: 1.532164</code></pre>
<p><strong>11.5</strong> Write a function to solve the equation <span class="math display">\[
\frac{2\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_0^{c_{k-1}}\big(1+\frac{u^2}{k-1}\big)^{-k/2}du\\=\frac{2\Gamma(\frac{k+1}{2})}{\sqrt{\pi
k}\Gamma(\frac{k}{2})}\int_0^{c_{k}}\big(1+\frac{u^2}{k}\big)^{-(k+1)/2}du
\]</span> for <span class="math inline">\(a\)</span>, where <span class="math display">\[
c_k=\sqrt{\frac{a^2k}{k+1-a^2}}.
\]</span> Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a><span class="co"># 加载必要的库</span></span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" tabindex="-1"></a><span class="co"># 定义常量 k 值</span></span>
<span id="cb124-5"><a href="#cb124-5" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb124-6"><a href="#cb124-6" tabindex="-1"></a></span>
<span id="cb124-7"><a href="#cb124-7" tabindex="-1"></a><span class="co"># 定义 c_k 的计算函数</span></span>
<span id="cb124-8"><a href="#cb124-8" tabindex="-1"></a>c_k <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb124-9"><a href="#cb124-9" tabindex="-1"></a>  <span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k) <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb124-10"><a href="#cb124-10" tabindex="-1"></a>}</span>
<span id="cb124-11"><a href="#cb124-11" tabindex="-1"></a></span>
<span id="cb124-12"><a href="#cb124-12" tabindex="-1"></a><span class="co"># 计算 S_{k-1}(a) 和 S_k(a) 的函数</span></span>
<span id="cb124-13"><a href="#cb124-13" tabindex="-1"></a>S_k <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb124-14"><a href="#cb124-14" tabindex="-1"></a>  critical_value <span class="ot">&lt;-</span> <span class="fu">c_k</span>(a,k)</span>
<span id="cb124-15"><a href="#cb124-15" tabindex="-1"></a>  <span class="fu">pt</span>(<span class="sc">-</span>critical_value, <span class="at">df =</span> k, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb124-16"><a href="#cb124-16" tabindex="-1"></a>}</span>
<span id="cb124-17"><a href="#cb124-17" tabindex="-1"></a></span>
<span id="cb124-18"><a href="#cb124-18" tabindex="-1"></a><span class="co"># 定义找到 A(k) 的函数</span></span>
<span id="cb124-19"><a href="#cb124-19" tabindex="-1"></a>find_A_k <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb124-20"><a href="#cb124-20" tabindex="-1"></a>  target_func <span class="ot">&lt;-</span> <span class="cf">function</span>(a) <span class="fu">S_k</span>(a, k<span class="dv">-1</span>) <span class="sc">-</span> <span class="fu">S_k</span>(a, k)</span>
<span id="cb124-21"><a href="#cb124-21" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(target_func, <span class="at">lower =</span> <span class="fl">0.001</span>, <span class="at">upper =</span> <span class="dv">2</span>)<span class="sc">$</span>root</span>
<span id="cb124-22"><a href="#cb124-22" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb124-23"><a href="#cb124-23" tabindex="-1"></a>}</span>
<span id="cb124-24"><a href="#cb124-24" tabindex="-1"></a></span>
<span id="cb124-25"><a href="#cb124-25" tabindex="-1"></a><span class="co"># 计算 A(k) 值</span></span>
<span id="cb124-26"><a href="#cb124-26" tabindex="-1"></a>A_k_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(k_values, find_A_k)</span>
<span id="cb124-27"><a href="#cb124-27" tabindex="-1"></a></span>
<span id="cb124-28"><a href="#cb124-28" tabindex="-1"></a><span class="co"># 定义积分部分用于解方程的函数</span></span>
<span id="cb124-29"><a href="#cb124-29" tabindex="-1"></a>left_integral <span class="ot">&lt;-</span> <span class="cf">function</span>(c_k1, k) {</span>
<span id="cb124-30"><a href="#cb124-30" tabindex="-1"></a>  <span class="fu">integrate</span>(<span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (k <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">^</span>(<span class="sc">-</span>k <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">0</span>, c_k1)<span class="sc">$</span>value</span>
<span id="cb124-31"><a href="#cb124-31" tabindex="-1"></a>}</span>
<span id="cb124-32"><a href="#cb124-32" tabindex="-1"></a></span>
<span id="cb124-33"><a href="#cb124-33" tabindex="-1"></a>right_integral <span class="ot">&lt;-</span> <span class="cf">function</span>(c_k2, k) {</span>
<span id="cb124-34"><a href="#cb124-34" tabindex="-1"></a>  <span class="fu">integrate</span>(<span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">0</span>, c_k2)<span class="sc">$</span>value</span>
<span id="cb124-35"><a href="#cb124-35" tabindex="-1"></a>}</span>
<span id="cb124-36"><a href="#cb124-36" tabindex="-1"></a></span>
<span id="cb124-37"><a href="#cb124-37" tabindex="-1"></a><span class="co"># 定义方程求解函数，找到满足方程的a值</span></span>
<span id="cb124-38"><a href="#cb124-38" tabindex="-1"></a>solve_for_a <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb124-39"><a href="#cb124-39" tabindex="-1"></a>  target_func <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb124-40"><a href="#cb124-40" tabindex="-1"></a>    <span class="co"># 计算 c_{k-1} 和 c_k</span></span>
<span id="cb124-41"><a href="#cb124-41" tabindex="-1"></a>    c_k1 <span class="ot">&lt;-</span> <span class="fu">c_k</span>(a, k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb124-42"><a href="#cb124-42" tabindex="-1"></a>    c_k2 <span class="ot">&lt;-</span> <span class="fu">c_k</span>(a, k)</span>
<span id="cb124-43"><a href="#cb124-43" tabindex="-1"></a>    </span>
<span id="cb124-44"><a href="#cb124-44" tabindex="-1"></a>    <span class="co"># 计算方程的左侧和右侧</span></span>
<span id="cb124-45"><a href="#cb124-45" tabindex="-1"></a>    </span>
<span id="cb124-46"><a href="#cb124-46" tabindex="-1"></a>    left_side <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>(k <span class="sc">/</span> <span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>))<span class="sc">*</span>(<span class="dv">2</span> ) <span class="sc">/</span> (<span class="fu">sqrt</span>(pi <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>))) <span class="sc">*</span> <span class="fu">left_integral</span>(c_k1, k)</span>
<span id="cb124-47"><a href="#cb124-47" tabindex="-1"></a>    right_side <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((k) <span class="sc">/</span> <span class="dv">2</span>))<span class="sc">*</span>(<span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">sqrt</span>(pi <span class="sc">*</span> k)) <span class="sc">*</span> <span class="fu">right_integral</span>(c_k2, k)</span>
<span id="cb124-48"><a href="#cb124-48" tabindex="-1"></a>    </span>
<span id="cb124-49"><a href="#cb124-49" tabindex="-1"></a>    <span class="co"># 返回左右差值</span></span>
<span id="cb124-50"><a href="#cb124-50" tabindex="-1"></a>    left_side <span class="sc">-</span> right_side</span>
<span id="cb124-51"><a href="#cb124-51" tabindex="-1"></a>  }</span>
<span id="cb124-52"><a href="#cb124-52" tabindex="-1"></a>  </span>
<span id="cb124-53"><a href="#cb124-53" tabindex="-1"></a>  <span class="co"># 使用 uniroot 求解方程，找到 a 的值</span></span>
<span id="cb124-54"><a href="#cb124-54" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(target_func,<span class="fu">c</span>(<span class="fl">0.0001</span>,<span class="dv">2</span>))<span class="sc">$</span>root</span>
<span id="cb124-55"><a href="#cb124-55" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb124-56"><a href="#cb124-56" tabindex="-1"></a>}</span>
<span id="cb124-57"><a href="#cb124-57" tabindex="-1"></a></span>
<span id="cb124-58"><a href="#cb124-58" tabindex="-1"></a><span class="co"># 计算解方程得到的 a 值</span></span>
<span id="cb124-59"><a href="#cb124-59" tabindex="-1"></a>a_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(k_values, solve_for_a)</span>
<span id="cb124-60"><a href="#cb124-60" tabindex="-1"></a></span>
<span id="cb124-61"><a href="#cb124-61" tabindex="-1"></a><span class="co"># 打印和比较 A(k) 与求解方程得到的 a 值</span></span>
<span id="cb124-62"><a href="#cb124-62" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> k_values, <span class="at">A_k =</span> A_k_values, <span class="at">a_solved =</span> a_values)</span>
<span id="cb124-63"><a href="#cb124-63" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code></pre></div>
<pre><code>##       k      A_k a_solved
## 1     4 1.492103 1.492103
## 2     5 1.533556 1.533556
## 3     6 1.562745 1.562744
## 4     7 1.584430 1.584430
## 5     8 1.601185 1.601185
## 6     9 1.614521 1.614521
## 7    10 1.625390 1.625390
## 8    11 1.634419 1.634419
## 9    12 1.642038 1.642038
## 10   13 1.648554 1.648554
## 11   14 1.654191 1.654190
## 12   15 1.659114 1.659114
## 13   16 1.663452 1.663452
## 14   17 1.667304 1.667304
## 15   18 1.670746 1.670745
## 16   19 1.673840 1.673840
## 17   20 1.676637 1.676637
## 18   21 1.679178 1.679178
## 19   22 1.681496 1.681496
## 20   23 1.683620 1.683620
## 21   24 1.685572 1.685572
## 22   25 1.687374 1.687373
## 23  100 1.720608 1.720608
## 24  500 1.729755 1.729755
## 25 1000 1.730907 1.730907</code></pre>
<p>从输出结果可以看出方程的解与<span class="math inline">\(A(k)\)</span>非常接近。</p>
<p>Suppose <span class="math inline">\(T_1,...,T_n\)</span> are i.i.d.
samples drawn from the exponential distribution with expectation <span class="math inline">\(λ\)</span>. Those values greater than <span class="math inline">\(τ\)</span> are not observed due to right
censorship, so that the observed values are <span class="math inline">\(Y_i = T_iI(T_i ≤ τ) + τI(T_i &gt; τ), i =
1,...,n.\)</span> Suppose <span class="math inline">\(τ = 1\)</span> and
the observed <span class="math inline">\(Y_i\)</span> values are as
follows: <span class="math display">\[
0.54, 0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85
\]</span> Use the E-M algorithm to estimate <span class="math inline">\(λ\)</span>, compare your result with the observed
data MLE (note: <span class="math inline">\(Y_i\)</span> follows a
mixture distribution).</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a><span class="co"># 初始化观测数据和参数</span></span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(Y)</span>
<span id="cb126-5"><a href="#cb126-5" tabindex="-1"></a></span>
<span id="cb126-6"><a href="#cb126-6" tabindex="-1"></a><span class="co"># 初始lambda的估计值（可以随机或使用观测值的均值）</span></span>
<span id="cb126-7"><a href="#cb126-7" tabindex="-1"></a>lambda_est <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y)</span>
<span id="cb126-8"><a href="#cb126-8" tabindex="-1"></a></span>
<span id="cb126-9"><a href="#cb126-9" tabindex="-1"></a><span class="co"># 设置迭代参数</span></span>
<span id="cb126-10"><a href="#cb126-10" tabindex="-1"></a>tolerance <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb126-11"><a href="#cb126-11" tabindex="-1"></a>max_iter <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb126-12"><a href="#cb126-12" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb126-13"><a href="#cb126-13" tabindex="-1"></a>lambda_old <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb126-14"><a href="#cb126-14" tabindex="-1"></a>need.lambda <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb126-15"><a href="#cb126-15" tabindex="-1"></a></span>
<span id="cb126-16"><a href="#cb126-16" tabindex="-1"></a><span class="co"># EM算法迭代</span></span>
<span id="cb126-17"><a href="#cb126-17" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">abs</span>(lambda_est <span class="sc">-</span> lambda_old) <span class="sc">&gt;</span> tolerance <span class="sc">&amp;&amp;</span> iter <span class="sc">&lt;</span> max_iter) {</span>
<span id="cb126-18"><a href="#cb126-18" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb126-19"><a href="#cb126-19" tabindex="-1"></a>  lambda_old <span class="ot">&lt;-</span> lambda_est</span>
<span id="cb126-20"><a href="#cb126-20" tabindex="-1"></a>  </span>
<span id="cb126-21"><a href="#cb126-21" tabindex="-1"></a>  <span class="co"># E步：计算填补后的 T_i 的期望值</span></span>
<span id="cb126-22"><a href="#cb126-22" tabindex="-1"></a>  T_filled <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Y, <span class="cf">function</span>(y) {</span>
<span id="cb126-23"><a href="#cb126-23" tabindex="-1"></a>    <span class="cf">if</span> (y <span class="sc">&lt;</span> tau) {</span>
<span id="cb126-24"><a href="#cb126-24" tabindex="-1"></a>      <span class="fu">return</span>(y) <span class="co"># 未截尾的值直接取观测值</span></span>
<span id="cb126-25"><a href="#cb126-25" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb126-26"><a href="#cb126-26" tabindex="-1"></a>      <span class="fu">return</span>(tau <span class="sc">+</span> lambda_est) <span class="co"># 截尾的情况</span></span>
<span id="cb126-27"><a href="#cb126-27" tabindex="-1"></a>    }</span>
<span id="cb126-28"><a href="#cb126-28" tabindex="-1"></a>  })</span>
<span id="cb126-29"><a href="#cb126-29" tabindex="-1"></a>  </span>
<span id="cb126-30"><a href="#cb126-30" tabindex="-1"></a>  <span class="co"># M步：更新lambda的估计值</span></span>
<span id="cb126-31"><a href="#cb126-31" tabindex="-1"></a>  lambda_est <span class="ot">&lt;-</span> <span class="fu">mean</span>(T_filled)</span>
<span id="cb126-32"><a href="#cb126-32" tabindex="-1"></a>  need.lambda <span class="ot">&lt;-</span> <span class="fu">c</span>(need.lambda,lambda_est)</span>
<span id="cb126-33"><a href="#cb126-33" tabindex="-1"></a>}</span>
<span id="cb126-34"><a href="#cb126-34" tabindex="-1"></a></span>
<span id="cb126-35"><a href="#cb126-35" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;EM算法估计的lambda:&quot;</span>, lambda_est, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## EM算法估计的lambda: 0.9642856</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="co"># 观测数据的 MLE 估计（仅用未截尾的数据）</span></span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)<span class="sc">/</span><span class="dv">7</span></span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;观测数据 MLE 估计的lambda:&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 观测数据 MLE 估计的lambda: 0.9642857</code></pre>
<p>从以上结果得到<span class="math inline">\(\lambda\)</span>的 EM
算法估计值与 MLE 估计非常接近。</p>
<p><strong>HW8</strong></p>
<p><strong>1</strong> Use the simplex algorithm to solve the following
problem. Minimize <span class="math inline">\(4x +2y +9z\)</span>
subject to <span class="math display">\[
2x+y+z≤2\\
x−y+3z ≤3\\
x ≥0,y≥0,z≥0.
\]</span></p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="co"># 加载线性规划包</span></span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a><span class="fu">library</span>(lpSolve)</span></code></pre></div>
<pre><code>## Warning: package &#39;lpSolve&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="co"># 定义目标函数系数</span></span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb132-3"><a href="#cb132-3" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" tabindex="-1"></a><span class="co"># 定义约束条件矩阵</span></span>
<span id="cb132-5"><a href="#cb132-5" tabindex="-1"></a>const_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb132-6"><a href="#cb132-6" tabindex="-1"></a>  <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>,   <span class="co"># 2x + y + z &lt;= 2</span></span>
<span id="cb132-7"><a href="#cb132-7" tabindex="-1"></a>  <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>   <span class="co"># x - y + 3z &lt;= 3</span></span>
<span id="cb132-8"><a href="#cb132-8" tabindex="-1"></a>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-9"><a href="#cb132-9" tabindex="-1"></a></span>
<span id="cb132-10"><a href="#cb132-10" tabindex="-1"></a><span class="co"># 定义约束条件的右侧值</span></span>
<span id="cb132-11"><a href="#cb132-11" tabindex="-1"></a>const_rhs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb132-12"><a href="#cb132-12" tabindex="-1"></a></span>
<span id="cb132-13"><a href="#cb132-13" tabindex="-1"></a><span class="co"># 定义约束方向</span></span>
<span id="cb132-14"><a href="#cb132-14" tabindex="-1"></a>const_dir <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;&lt;=&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>)</span>
<span id="cb132-15"><a href="#cb132-15" tabindex="-1"></a></span>
<span id="cb132-16"><a href="#cb132-16" tabindex="-1"></a><span class="co"># 求解线性规划</span></span>
<span id="cb132-17"><a href="#cb132-17" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lp</span>(<span class="st">&quot;min&quot;</span>, obj, const_mat, const_dir, const_rhs, <span class="at">all.int =</span> <span class="cn">FALSE</span>)</span>
<span id="cb132-18"><a href="#cb132-18" tabindex="-1"></a></span>
<span id="cb132-19"><a href="#cb132-19" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb132-20"><a href="#cb132-20" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb132-21"><a href="#cb132-21" tabindex="-1"></a>  <span class="at">Optimal_Value =</span> result<span class="sc">$</span>objval,</span>
<span id="cb132-22"><a href="#cb132-22" tabindex="-1"></a>  <span class="at">Solution =</span> result<span class="sc">$</span>solution</span>
<span id="cb132-23"><a href="#cb132-23" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## $Optimal_Value
## [1] 0
## 
## $Solution
## [1] 0 0 0</code></pre>
<p>从输出结果可以看出，当<span class="math inline">\(x=y=z=0\)</span>时，<span class="math inline">\(4x
+2y +9z\)</span>达到最小值0。</p>
<p><strong>2</strong> Use both for loops and lapply() to fit linear
models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt,
mpg ~ I(1 / disp) + wt )</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="co"># 定义公式列表</span></span>
<span id="cb134-2"><a href="#cb134-2" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb134-3"><a href="#cb134-3" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb134-4"><a href="#cb134-4" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb134-5"><a href="#cb134-5" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb134-6"><a href="#cb134-6" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb134-7"><a href="#cb134-7" tabindex="-1"></a>)</span>
<span id="cb134-8"><a href="#cb134-8" tabindex="-1"></a></span>
<span id="cb134-9"><a href="#cb134-9" tabindex="-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb134-10"><a href="#cb134-10" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb134-11"><a href="#cb134-11" tabindex="-1"></a><span class="co"># 初始化存储模型结果的列表</span></span>
<span id="cb134-12"><a href="#cb134-12" tabindex="-1"></a>models_for <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb134-13"><a href="#cb134-13" tabindex="-1"></a></span>
<span id="cb134-14"><a href="#cb134-14" tabindex="-1"></a><span class="co"># 使用 for 循环拟合线性模型</span></span>
<span id="cb134-15"><a href="#cb134-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)) {</span>
<span id="cb134-16"><a href="#cb134-16" tabindex="-1"></a>  models_for[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb134-17"><a href="#cb134-17" tabindex="-1"></a>}</span>
<span id="cb134-18"><a href="#cb134-18" tabindex="-1"></a></span>
<span id="cb134-19"><a href="#cb134-19" tabindex="-1"></a><span class="co"># 使用 lapply 拟合线性模型</span></span>
<span id="cb134-20"><a href="#cb134-20" tabindex="-1"></a>models_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="fu">lm</span>(f, <span class="at">data =</span> mtcars))</span>
<span id="cb134-21"><a href="#cb134-21" tabindex="-1"></a></span>
<span id="cb134-22"><a href="#cb134-22" tabindex="-1"></a></span>
<span id="cb134-23"><a href="#cb134-23" tabindex="-1"></a><span class="co"># 使用 for 循环查看系数</span></span>
<span id="cb134-24"><a href="#cb134-24" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(models_for)) {</span>
<span id="cb134-25"><a href="#cb134-25" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Model&quot;</span>, i, <span class="st">&quot;coefficients:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb134-26"><a href="#cb134-26" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">coef</span>(models_for[[i]]))</span>
<span id="cb134-27"><a href="#cb134-27" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb134-28"><a href="#cb134-28" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Model 1 coefficients:
## (Intercept)        disp 
## 29.59985476 -0.04121512 
## 
## Model 2 coefficients:
## (Intercept)   I(1/disp) 
##    10.75202  1557.67393 
## 
## Model 3 coefficients:
## (Intercept)        disp          wt 
## 34.96055404 -0.01772474 -3.35082533 
## 
## Model 4 coefficients:
## (Intercept)   I(1/disp)          wt 
##   19.024206 1142.559975   -1.797649</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="co"># 使用 lapply 查看系数</span></span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a><span class="fu">lapply</span>(models_lapply, coef)</span></code></pre></div>
<pre><code>## [[1]]
## (Intercept)        disp 
## 29.59985476 -0.04121512 
## 
## [[2]]
## (Intercept)   I(1/disp) 
##    10.75202  1557.67393 
## 
## [[3]]
## (Intercept)        disp          wt 
## 34.96055404 -0.01772474 -3.35082533 
## 
## [[4]]
## (Intercept)   I(1/disp)          wt 
##   19.024206 1142.559975   -1.797649</code></pre>
<p>从以上结果可以看出 for 循环和 lapply()方法
得到的拟合模型结果完全一致。</p>
<p><strong>3</strong> Fit the model mpg ~ disp to each of the bootstrap
replicates of mtcars in the list below by using a for loop and lapply().
Can you do it without an anonymous function?</p>
<p>bootstraps &lt;- lapply(1:10, function(i) { rows &lt;-
sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="co"># 创建引导样本列表</span></span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子以便结果可重复</span></span>
<span id="cb138-3"><a href="#cb138-3" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb138-4"><a href="#cb138-4" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-5"><a href="#cb138-5" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb138-6"><a href="#cb138-6" tabindex="-1"></a>})</span>
<span id="cb138-7"><a href="#cb138-7" tabindex="-1"></a><span class="co"># 初始化存储模型的列表</span></span>
<span id="cb138-8"><a href="#cb138-8" tabindex="-1"></a>models_for <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb138-9"><a href="#cb138-9" tabindex="-1"></a></span>
<span id="cb138-10"><a href="#cb138-10" tabindex="-1"></a><span class="co"># 使用 for 循环对每个引导样本拟合模型</span></span>
<span id="cb138-11"><a href="#cb138-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)) {</span>
<span id="cb138-12"><a href="#cb138-12" tabindex="-1"></a>  models_for[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstraps[[i]])</span>
<span id="cb138-13"><a href="#cb138-13" tabindex="-1"></a>}</span>
<span id="cb138-14"><a href="#cb138-14" tabindex="-1"></a></span>
<span id="cb138-15"><a href="#cb138-15" tabindex="-1"></a><span class="co"># 定义一个专用的拟合函数</span></span>
<span id="cb138-16"><a href="#cb138-16" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> lm  <span class="co"># 因为公式固定为 mpg ~ disp，因此可以直接传递公式</span></span>
<span id="cb138-17"><a href="#cb138-17" tabindex="-1"></a></span>
<span id="cb138-18"><a href="#cb138-18" tabindex="-1"></a><span class="co"># 使用 lapply 对引导样本拟合模型</span></span>
<span id="cb138-19"><a href="#cb138-19" tabindex="-1"></a>models_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, fit_model, <span class="at">formula =</span> mpg <span class="sc">~</span> disp)</span>
<span id="cb138-20"><a href="#cb138-20" tabindex="-1"></a></span>
<span id="cb138-21"><a href="#cb138-21" tabindex="-1"></a><span class="co"># 使用 for 循环查看系数</span></span>
<span id="cb138-22"><a href="#cb138-22" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(models_for)) {</span>
<span id="cb138-23"><a href="#cb138-23" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Model&quot;</span>, i, <span class="st">&quot;coefficients:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb138-24"><a href="#cb138-24" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">coef</span>(models_for[[i]]))</span>
<span id="cb138-25"><a href="#cb138-25" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb138-26"><a href="#cb138-26" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Model 1 coefficients:
## (Intercept)        disp 
## 29.59804025 -0.03797831 
## 
## Model 2 coefficients:
## (Intercept)        disp 
## 27.38760407 -0.03411317 
## 
## Model 3 coefficients:
## (Intercept)        disp 
## 30.27666550 -0.04175611 
## 
## Model 4 coefficients:
## (Intercept)        disp 
## 27.25456701 -0.03270754 
## 
## Model 5 coefficients:
## (Intercept)        disp 
## 29.07161410 -0.04128939 
## 
## Model 6 coefficients:
## (Intercept)        disp 
## 28.51715577 -0.03935732 
## 
## Model 7 coefficients:
## (Intercept)        disp 
##  31.7497532  -0.0464673 
## 
## Model 8 coefficients:
## (Intercept)        disp 
## 27.47887336 -0.03404925 
## 
## Model 9 coefficients:
## (Intercept)        disp 
##  29.5774947  -0.0404346 
## 
## Model 10 coefficients:
## (Intercept)        disp 
## 29.60505274 -0.04017415</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="co"># 使用 lapply 查看系数</span></span>
<span id="cb140-2"><a href="#cb140-2" tabindex="-1"></a><span class="fu">lapply</span>(models_lapply, coef)</span></code></pre></div>
<pre><code>## [[1]]
## (Intercept)        disp 
## 29.59804025 -0.03797831 
## 
## [[2]]
## (Intercept)        disp 
## 27.38760407 -0.03411317 
## 
## [[3]]
## (Intercept)        disp 
## 30.27666550 -0.04175611 
## 
## [[4]]
## (Intercept)        disp 
## 27.25456701 -0.03270754 
## 
## [[5]]
## (Intercept)        disp 
## 29.07161410 -0.04128939 
## 
## [[6]]
## (Intercept)        disp 
## 28.51715577 -0.03935732 
## 
## [[7]]
## (Intercept)        disp 
##  31.7497532  -0.0464673 
## 
## [[8]]
## (Intercept)        disp 
## 27.47887336 -0.03404925 
## 
## [[9]]
## (Intercept)        disp 
##  29.5774947  -0.0404346 
## 
## [[10]]
## (Intercept)        disp 
## 29.60505274 -0.04017415</code></pre>
<p>从以上结果可以看出，在不使用匿名函数的条件下依然可以完成任务(for
循环和 lapply()方法得到的模型结果完全一致)。</p>
<p><strong>4</strong> For each model in the previous two exercises,
extract <span class="math inline">\(R^2\)</span> using the function
below.</p>
<p>rsq &lt;- function(mod) summary(mod)$r.squared</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a><span class="co"># 定义 rsq 函数，用于提取模型的 R^2</span></span>
<span id="cb142-2"><a href="#cb142-2" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) {</span>
<span id="cb142-3"><a href="#cb142-3" tabindex="-1"></a>  <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb142-4"><a href="#cb142-4" tabindex="-1"></a>}</span>
<span id="cb142-5"><a href="#cb142-5" tabindex="-1"></a></span>
<span id="cb142-6"><a href="#cb142-6" tabindex="-1"></a><span class="co"># 提取 for 循环中每个模型的 R^2</span></span>
<span id="cb142-7"><a href="#cb142-7" tabindex="-1"></a>r_squared_for <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(models_for))  <span class="co"># 初始化存储 R^2 的向量</span></span>
<span id="cb142-8"><a href="#cb142-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(models_for)) {</span>
<span id="cb142-9"><a href="#cb142-9" tabindex="-1"></a>  r_squared_for[i] <span class="ot">&lt;-</span> <span class="fu">rsq</span>(models_for[[i]])</span>
<span id="cb142-10"><a href="#cb142-10" tabindex="-1"></a>}</span>
<span id="cb142-11"><a href="#cb142-11" tabindex="-1"></a></span>
<span id="cb142-12"><a href="#cb142-12" tabindex="-1"></a><span class="co"># 查看结果</span></span>
<span id="cb142-13"><a href="#cb142-13" tabindex="-1"></a>r_squared_for</span></code></pre></div>
<pre><code>##  [1] 0.6497636 0.6820834 0.7530595 0.6101709 0.7226119 0.7533418 0.7311415
##  [8] 0.6293502 0.6554375 0.7238971</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a><span class="co"># 使用 lapply 提取每个模型的 R^2</span></span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a>r_squared_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(models_lapply, rsq)  </span>
<span id="cb144-3"><a href="#cb144-3" tabindex="-1"></a></span>
<span id="cb144-4"><a href="#cb144-4" tabindex="-1"></a><span class="co"># 查看结果</span></span>
<span id="cb144-5"><a href="#cb144-5" tabindex="-1"></a>r_squared_lapply</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6497636
## 
## [[2]]
## [1] 0.6820834
## 
## [[3]]
## [1] 0.7530595
## 
## [[4]]
## [1] 0.6101709
## 
## [[5]]
## [1] 0.7226119
## 
## [[6]]
## [1] 0.7533418
## 
## [[7]]
## [1] 0.7311415
## 
## [[8]]
## [1] 0.6293502
## 
## [[9]]
## [1] 0.6554375
## 
## [[10]]
## [1] 0.7238971</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a><span class="co"># 比较两种方法的结果是否一致</span></span>
<span id="cb146-2"><a href="#cb146-2" tabindex="-1"></a><span class="co">#all.equal(r_squared_for, r_squared_lapply)</span></span></code></pre></div>
<p>从以上结果可以看出，for 循环和 lapply()方法得到的<span class="math inline">\(R^2\)</span>完全一致。</p>
<p><strong>5</strong> The following code simulates the performance of a
t-test for non-normal data. Use sapply() and an anonymous function to
extract the p-value from every trial.</p>
<p>trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)),
simplify = FALSE )</p>
<p>Extra challenge: get rid of the anonymous function by using [[
directly.</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb147-2"><a href="#cb147-2" tabindex="-1"></a> <span class="dv">100</span>,</span>
<span id="cb147-3"><a href="#cb147-3" tabindex="-1"></a> <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb147-4"><a href="#cb147-4" tabindex="-1"></a> <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb147-5"><a href="#cb147-5" tabindex="-1"></a> )</span>
<span id="cb147-6"><a href="#cb147-6" tabindex="-1"></a><span class="co"># 使用 sapply 和匿名函数提取 p-value</span></span>
<span id="cb147-7"><a href="#cb147-7" tabindex="-1"></a>p_values_anonymous <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="cf">function</span>(trial) trial<span class="sc">$</span>p.value)</span>
<span id="cb147-8"><a href="#cb147-8" tabindex="-1"></a></span>
<span id="cb147-9"><a href="#cb147-9" tabindex="-1"></a><span class="co"># 查看前几个 p-value</span></span>
<span id="cb147-10"><a href="#cb147-10" tabindex="-1"></a><span class="fu">head</span>(p_values_anonymous)</span></code></pre></div>
<pre><code>## [1] 0.8079199 0.6655118 0.8277717 0.5348996 0.2117373 0.5286436</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" tabindex="-1"></a><span class="co"># 使用 [[ 直接提取 p-value</span></span>
<span id="cb149-2"><a href="#cb149-2" tabindex="-1"></a>p_values_direct <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="st">`</span><span class="at">[[</span><span class="st">`</span>, <span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb149-3"><a href="#cb149-3" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" tabindex="-1"></a><span class="co"># 查看前几个 p-value</span></span>
<span id="cb149-5"><a href="#cb149-5" tabindex="-1"></a><span class="fu">head</span>(p_values_direct)</span></code></pre></div>
<pre><code>## [1] 0.8079199 0.6655118 0.8277717 0.5348996 0.2117373 0.5286436</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" tabindex="-1"></a><span class="co"># 验证结果是否一致</span></span>
<span id="cb151-2"><a href="#cb151-2" tabindex="-1"></a><span class="fu">all.equal</span>(p_values_anonymous, p_values_direct)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>从以上结果可以得到，使用匿名函数前后，应用 sapply() 方法提取的 <span class="math inline">\(p\)</span> 值一致。</p>
<p><strong>6</strong> Implement a combination of Map() and vapply() to
create an lapply() variant that iterates in parallel over all of its
inputs and stores its outputs in a vector (or a matrix). What arguments
should the function take?</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a>my_lapply_variant <span class="ot">&lt;-</span> <span class="cf">function</span>(FUN, ..., FUN.VALUE, <span class="at">USE.NAMES =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb153-2"><a href="#cb153-2" tabindex="-1"></a>  <span class="co"># 参数说明：</span></span>
<span id="cb153-3"><a href="#cb153-3" tabindex="-1"></a>  <span class="co"># FUN: 应用于每组输入的函数</span></span>
<span id="cb153-4"><a href="#cb153-4" tabindex="-1"></a>  <span class="co"># ...: 多个并行输入</span></span>
<span id="cb153-5"><a href="#cb153-5" tabindex="-1"></a>  <span class="co"># FUN.VALUE: 输出的预期类型或结构，用于 vapply 验证</span></span>
<span id="cb153-6"><a href="#cb153-6" tabindex="-1"></a>  <span class="co"># USE.NAMES: 是否保留输出的名称</span></span>
<span id="cb153-7"><a href="#cb153-7" tabindex="-1"></a>  </span>
<span id="cb153-8"><a href="#cb153-8" tabindex="-1"></a>  <span class="co"># 使用 Map 在并行输入上迭代</span></span>
<span id="cb153-9"><a href="#cb153-9" tabindex="-1"></a>  mapped_results <span class="ot">&lt;-</span> <span class="fu">Map</span>(FUN, ...)</span>
<span id="cb153-10"><a href="#cb153-10" tabindex="-1"></a>  </span>
<span id="cb153-11"><a href="#cb153-11" tabindex="-1"></a>  <span class="co"># 使用 vapply 对每个结果进行验证并返回向量/矩阵</span></span>
<span id="cb153-12"><a href="#cb153-12" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">vapply</span>(mapped_results, identity, FUN.VALUE, <span class="at">USE.NAMES =</span> USE.NAMES)</span>
<span id="cb153-13"><a href="#cb153-13" tabindex="-1"></a>  </span>
<span id="cb153-14"><a href="#cb153-14" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb153-15"><a href="#cb153-15" tabindex="-1"></a>}</span>
<span id="cb153-16"><a href="#cb153-16" tabindex="-1"></a></span>
<span id="cb153-17"><a href="#cb153-17" tabindex="-1"></a><span class="co"># 定义并行输入，需要对它们的每组元素求和</span></span>
<span id="cb153-18"><a href="#cb153-18" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb153-19"><a href="#cb153-19" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb153-20"><a href="#cb153-20" tabindex="-1"></a></span>
<span id="cb153-21"><a href="#cb153-21" tabindex="-1"></a><span class="co"># 应用函数：对 x 和 y 中的每组值求和</span></span>
<span id="cb153-22"><a href="#cb153-22" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">my_lapply_variant</span>(</span>
<span id="cb153-23"><a href="#cb153-23" tabindex="-1"></a>  <span class="at">FUN =</span> <span class="cf">function</span>(a, b) a <span class="sc">+</span> b,  <span class="co"># 自定义函数：求和</span></span>
<span id="cb153-24"><a href="#cb153-24" tabindex="-1"></a>  x, y,                       <span class="co"># 并行输入</span></span>
<span id="cb153-25"><a href="#cb153-25" tabindex="-1"></a>  <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>),     <span class="co"># 输出为标量</span></span>
<span id="cb153-26"><a href="#cb153-26" tabindex="-1"></a>  <span class="at">USE.NAMES =</span> <span class="cn">TRUE</span>           <span class="co"># 不保留名称</span></span>
<span id="cb153-27"><a href="#cb153-27" tabindex="-1"></a>)</span>
<span id="cb153-28"><a href="#cb153-28" tabindex="-1"></a></span>
<span id="cb153-29"><a href="#cb153-29" tabindex="-1"></a><span class="fu">print</span>(result)  <span class="co"># 输出结果</span></span></code></pre></div>
<pre><code>## [1]  7  9 11 13 15</code></pre>
<p>构建的函数需要“自定义函数”、“并行输入”、“输出的预期类型”、“是否保留输出的名称”共四个参数。</p>
<p><strong>7</strong> Make a faster version of chisq.test() that only
computes the chi-square test statistic when the input is two numeric
vectors with no missing values. You can try simplifying chisq.test() or
by coding from the mathematical definition (<a href="http://en" class="uri">http://en</a>.
wikipedia.org/wiki/Pearson%27s_chi-squared_test).</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(observed, expected) {</span>
<span id="cb155-2"><a href="#cb155-2" tabindex="-1"></a>  <span class="co"># 参数说明：</span></span>
<span id="cb155-3"><a href="#cb155-3" tabindex="-1"></a>  <span class="co"># observed: 观察值的数值向量</span></span>
<span id="cb155-4"><a href="#cb155-4" tabindex="-1"></a>  <span class="co"># expected: 期望值的数值向量</span></span>
<span id="cb155-5"><a href="#cb155-5" tabindex="-1"></a>  </span>
<span id="cb155-6"><a href="#cb155-6" tabindex="-1"></a>  <span class="co"># 检查输入向量是否长度一致</span></span>
<span id="cb155-7"><a href="#cb155-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(observed) <span class="sc">!=</span> <span class="fu">length</span>(expected)) {</span>
<span id="cb155-8"><a href="#cb155-8" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;observed 和 expected 的长度必须相同&quot;</span>)</span>
<span id="cb155-9"><a href="#cb155-9" tabindex="-1"></a>  }</span>
<span id="cb155-10"><a href="#cb155-10" tabindex="-1"></a>  </span>
<span id="cb155-11"><a href="#cb155-11" tabindex="-1"></a>  <span class="co"># 检查是否有非正值</span></span>
<span id="cb155-12"><a href="#cb155-12" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(observed <span class="sc">&lt;=</span> <span class="dv">0</span>) <span class="sc">||</span> <span class="fu">any</span>(expected <span class="sc">&lt;=</span> <span class="dv">0</span>)) {</span>
<span id="cb155-13"><a href="#cb155-13" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;observed 和 expected 必须全为正数&quot;</span>)</span>
<span id="cb155-14"><a href="#cb155-14" tabindex="-1"></a>  }</span>
<span id="cb155-15"><a href="#cb155-15" tabindex="-1"></a>  </span>
<span id="cb155-16"><a href="#cb155-16" tabindex="-1"></a>  <span class="co"># 按卡方公式计算统计量</span></span>
<span id="cb155-17"><a href="#cb155-17" tabindex="-1"></a>  chi_square_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb155-18"><a href="#cb155-18" tabindex="-1"></a>  </span>
<span id="cb155-19"><a href="#cb155-19" tabindex="-1"></a>  <span class="co"># 自由度</span></span>
<span id="cb155-20"><a href="#cb155-20" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">length</span>(observed) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb155-21"><a href="#cb155-21" tabindex="-1"></a>  </span>
<span id="cb155-22"><a href="#cb155-22" tabindex="-1"></a>  <span class="co"># 计算 p 值</span></span>
<span id="cb155-23"><a href="#cb155-23" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(chi_square_stat, df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb155-24"><a href="#cb155-24" tabindex="-1"></a>  </span>
<span id="cb155-25"><a href="#cb155-25" tabindex="-1"></a>  <span class="co"># 返回结果</span></span>
<span id="cb155-26"><a href="#cb155-26" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb155-27"><a href="#cb155-27" tabindex="-1"></a>    <span class="at">statistic =</span> chi_square_stat,</span>
<span id="cb155-28"><a href="#cb155-28" tabindex="-1"></a>    <span class="at">df =</span> df,</span>
<span id="cb155-29"><a href="#cb155-29" tabindex="-1"></a>    <span class="at">p_value =</span> p_value</span>
<span id="cb155-30"><a href="#cb155-30" tabindex="-1"></a>  ))</span>
<span id="cb155-31"><a href="#cb155-31" tabindex="-1"></a>}</span>
<span id="cb155-32"><a href="#cb155-32" tabindex="-1"></a><span class="co"># 定义观察值和期望值</span></span>
<span id="cb155-33"><a href="#cb155-33" tabindex="-1"></a>observed <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>)</span>
<span id="cb155-34"><a href="#cb155-34" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">20</span>)</span>
<span id="cb155-35"><a href="#cb155-35" tabindex="-1"></a></span>
<span id="cb155-36"><a href="#cb155-36" tabindex="-1"></a><span class="co"># 调用快速卡方检验函数</span></span>
<span id="cb155-37"><a href="#cb155-37" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(observed, expected)</span>
<span id="cb155-38"><a href="#cb155-38" tabindex="-1"></a></span>
<span id="cb155-39"><a href="#cb155-39" tabindex="-1"></a><span class="co"># 查看结果</span></span>
<span id="cb155-40"><a href="#cb155-40" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## $statistic
## [1] 7.666667
## 
## $df
## [1] 2
## 
## $p_value
## [1] 0.02163737</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" tabindex="-1"></a>result_original <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="at">x =</span> observed, <span class="at">p =</span> expected <span class="sc">/</span> <span class="fu">sum</span>(expected), <span class="at">rescale.p =</span> <span class="cn">TRUE</span>)</span>
<span id="cb157-2"><a href="#cb157-2" tabindex="-1"></a>result_original<span class="sc">$</span>statistic</span></code></pre></div>
<pre><code>## X-squared 
##  7.666667</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" tabindex="-1"></a>result_original<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.02163737</code></pre>
<p><strong>8</strong> Can you make a faster version of table() for the
case of an input of two integer vectors with no missing values? Can you
use it to speed up your chi-square test?</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" tabindex="-1"></a><span class="co"># 自定义一个快速的 table 函数</span></span>
<span id="cb161-2"><a href="#cb161-2" tabindex="-1"></a>fast_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb161-3"><a href="#cb161-3" tabindex="-1"></a>  <span class="co"># 确保输入是整数向量</span></span>
<span id="cb161-4"><a href="#cb161-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.integer</span>(x) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.integer</span>(y)) {</span>
<span id="cb161-5"><a href="#cb161-5" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Inputs must be integer vectors.&quot;</span>)</span>
<span id="cb161-6"><a href="#cb161-6" tabindex="-1"></a>  }</span>
<span id="cb161-7"><a href="#cb161-7" tabindex="-1"></a>  <span class="co"># 获取 x 和 y 的唯一值范围</span></span>
<span id="cb161-8"><a href="#cb161-8" tabindex="-1"></a>  ux <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(x))</span>
<span id="cb161-9"><a href="#cb161-9" tabindex="-1"></a>  uy <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(y))</span>
<span id="cb161-10"><a href="#cb161-10" tabindex="-1"></a>  <span class="co"># 初始化计数矩阵</span></span>
<span id="cb161-11"><a href="#cb161-11" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span><span class="dt">L</span>, <span class="at">nrow =</span> <span class="fu">length</span>(ux), <span class="at">ncol =</span> <span class="fu">length</span>(uy))</span>
<span id="cb161-12"><a href="#cb161-12" tabindex="-1"></a>  <span class="co"># 使用双向索引快速填充计数矩阵</span></span>
<span id="cb161-13"><a href="#cb161-13" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb161-14"><a href="#cb161-14" tabindex="-1"></a>    result[<span class="fu">match</span>(x[i], ux), <span class="fu">match</span>(y[i], uy)] <span class="ot">&lt;-</span> result[<span class="fu">match</span>(x[i], ux), <span class="fu">match</span>(y[i], uy)] <span class="sc">+</span> <span class="dv">1</span><span class="dt">L</span></span>
<span id="cb161-15"><a href="#cb161-15" tabindex="-1"></a>  }</span>
<span id="cb161-16"><a href="#cb161-16" tabindex="-1"></a>  <span class="co"># 返回结果，带上行列名</span></span>
<span id="cb161-17"><a href="#cb161-17" tabindex="-1"></a>  <span class="fu">dimnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">list</span>(ux, uy)</span>
<span id="cb161-18"><a href="#cb161-18" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb161-19"><a href="#cb161-19" tabindex="-1"></a>}</span>
<span id="cb161-20"><a href="#cb161-20" tabindex="-1"></a></span>
<span id="cb161-21"><a href="#cb161-21" tabindex="-1"></a><span class="co"># 用于加速卡方检验的实现，包含 P 值计算</span></span>
<span id="cb161-22"><a href="#cb161-22" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb161-23"><a href="#cb161-23" tabindex="-1"></a>  <span class="co"># 确保输入是整数向量</span></span>
<span id="cb161-24"><a href="#cb161-24" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.integer</span>(x) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.integer</span>(y)) {</span>
<span id="cb161-25"><a href="#cb161-25" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Inputs must be integer vectors.&quot;</span>)</span>
<span id="cb161-26"><a href="#cb161-26" tabindex="-1"></a>  }</span>
<span id="cb161-27"><a href="#cb161-27" tabindex="-1"></a>  <span class="co"># 生成快速的列联表</span></span>
<span id="cb161-28"><a href="#cb161-28" tabindex="-1"></a>  observed <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb161-29"><a href="#cb161-29" tabindex="-1"></a>  <span class="co"># 计算期望频数</span></span>
<span id="cb161-30"><a href="#cb161-30" tabindex="-1"></a>  row_sums <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(observed)</span>
<span id="cb161-31"><a href="#cb161-31" tabindex="-1"></a>  col_sums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(observed)</span>
<span id="cb161-32"><a href="#cb161-32" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">sum</span>(observed)</span>
<span id="cb161-33"><a href="#cb161-33" tabindex="-1"></a>  expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_sums, col_sums) <span class="sc">/</span> total</span>
<span id="cb161-34"><a href="#cb161-34" tabindex="-1"></a>  <span class="co"># 计算卡方统计量</span></span>
<span id="cb161-35"><a href="#cb161-35" tabindex="-1"></a>  chisq_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb161-36"><a href="#cb161-36" tabindex="-1"></a>  <span class="co"># 计算自由度</span></span>
<span id="cb161-37"><a href="#cb161-37" tabindex="-1"></a>  df <span class="ot">&lt;-</span> (<span class="fu">nrow</span>(observed) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">ncol</span>(observed) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb161-38"><a href="#cb161-38" tabindex="-1"></a>  <span class="co"># 计算 P 值</span></span>
<span id="cb161-39"><a href="#cb161-39" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(chisq_stat, df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb161-40"><a href="#cb161-40" tabindex="-1"></a>  <span class="co"># 返回结果，包括统计量和 P 值</span></span>
<span id="cb161-41"><a href="#cb161-41" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb161-42"><a href="#cb161-42" tabindex="-1"></a>    <span class="at">chisq_stat =</span> chisq_stat,</span>
<span id="cb161-43"><a href="#cb161-43" tabindex="-1"></a>    <span class="at">df =</span> df,</span>
<span id="cb161-44"><a href="#cb161-44" tabindex="-1"></a>    <span class="at">p_value =</span> p_value</span>
<span id="cb161-45"><a href="#cb161-45" tabindex="-1"></a>  ))</span>
<span id="cb161-46"><a href="#cb161-46" tabindex="-1"></a>}</span>
<span id="cb161-47"><a href="#cb161-47" tabindex="-1"></a></span>
<span id="cb161-48"><a href="#cb161-48" tabindex="-1"></a><span class="co"># 示例用法</span></span>
<span id="cb161-49"><a href="#cb161-49" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb161-50"><a href="#cb161-50" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb161-51"><a href="#cb161-51" tabindex="-1"></a></span>
<span id="cb161-52"><a href="#cb161-52" tabindex="-1"></a><span class="co"># 快速计算列联表</span></span>
<span id="cb161-53"><a href="#cb161-53" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Fast Table Result:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Fast Table Result:</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">fast_table</span>(x, y))</span></code></pre></div>
<pre><code>##   1 2 3
## 1 2 1 0
## 2 1 1 1
## 3 1 1 1</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" tabindex="-1"></a><span class="co"># 快速计算卡方检验统计量和 P 值</span></span>
<span id="cb165-2"><a href="#cb165-2" tabindex="-1"></a>fast_result <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(x, y)</span>
<span id="cb165-3"><a href="#cb165-3" tabindex="-1"></a></span>
<span id="cb165-4"><a href="#cb165-4" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb165-5"><a href="#cb165-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Fast Chi-Square Test Result:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Fast Chi-Square Test Result:</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Chi-Square Statistic:&quot;</span>, fast_result<span class="sc">$</span>chisq_stat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Chi-Square Statistic: 1.5</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Degrees of Freedom:&quot;</span>, fast_result<span class="sc">$</span>df, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Degrees of Freedom: 4</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;P-Value:&quot;</span>, fast_result<span class="sc">$</span>p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## P-Value: 0.8266415</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" tabindex="-1"></a><span class="co"># 验证与标准 chisq.test 的结果是否一致</span></span>
<span id="cb173-2"><a href="#cb173-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Standard chisq.test Result:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Standard chisq.test Result:</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" tabindex="-1"></a>chisq_test_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="fu">fast_table</span>(x, y))</span></code></pre></div>
<pre><code>## Warning in chisq.test(fast_table(x, y)): Chi-squared approximation may be
## incorrect</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" tabindex="-1"></a><span class="fu">print</span>(chisq_test_result)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  fast_table(x, y)
## X-squared = 1.5, df = 4, p-value = 0.8266</code></pre>
<p><strong>HW9</strong></p>
<p><strong>1</strong> This example appears in [40]. Consider the
bivariate density <span class="math display">\[
f(x,y)  \propto\tbinom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},~~x=0,1,...,n,~0\leq
y\leq1.
\]</span> It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a,b,n,\)</span> the conditional distributions are
Binomial(<span class="math inline">\(n,y\)</span>) and Beta(<span class="math inline">\(x+a,n−x+b\)</span>). Use the Gibbs sampler to
generate a chain with target joint density <span class="math inline">\(f(x,y)\)</span>.</p>
<p><strong>代码</strong></p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)  <span class="co"># 确保可重复性</span></span>
<span id="cb179-2"><a href="#cb179-2" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: package &#39;Rcpp&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;</span></span>
<span id="cb181-2"><a href="#cb181-2" tabindex="-1"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb181-3"><a href="#cb181-3" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb181-4"><a href="#cb181-4" tabindex="-1"></a></span>
<span id="cb181-5"><a href="#cb181-5" tabindex="-1"></a><span class="st">// Gibbs 采样器</span></span>
<span id="cb181-6"><a href="#cb181-6" tabindex="-1"></a><span class="st">// [[Rcpp::export]]</span></span>
<span id="cb181-7"><a href="#cb181-7" tabindex="-1"></a><span class="st">List gibbs_sampler(int n, double a, double b, int num_iter, double y_init) {</span></span>
<span id="cb181-8"><a href="#cb181-8" tabindex="-1"></a><span class="st">  // 存储采样结果</span></span>
<span id="cb181-9"><a href="#cb181-9" tabindex="-1"></a><span class="st">  NumericVector x_samples(num_iter);</span></span>
<span id="cb181-10"><a href="#cb181-10" tabindex="-1"></a><span class="st">  NumericVector y_samples(num_iter);</span></span>
<span id="cb181-11"><a href="#cb181-11" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb181-12"><a href="#cb181-12" tabindex="-1"></a><span class="st">  // 初始化变量</span></span>
<span id="cb181-13"><a href="#cb181-13" tabindex="-1"></a><span class="st">  double y = y_init;</span></span>
<span id="cb181-14"><a href="#cb181-14" tabindex="-1"></a><span class="st">  int x = 0;</span></span>
<span id="cb181-15"><a href="#cb181-15" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb181-16"><a href="#cb181-16" tabindex="-1"></a><span class="st">  for (int i = 0; i &lt; num_iter; i++) {</span></span>
<span id="cb181-17"><a href="#cb181-17" tabindex="-1"></a><span class="st">    // 从 Binomial(n, y) 中采样 x | y</span></span>
<span id="cb181-18"><a href="#cb181-18" tabindex="-1"></a><span class="st">    x = R::rbinom(n, y);</span></span>
<span id="cb181-19"><a href="#cb181-19" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb181-20"><a href="#cb181-20" tabindex="-1"></a><span class="st">    // 从 Beta(x + a, n - x + b) 中采样 y | x</span></span>
<span id="cb181-21"><a href="#cb181-21" tabindex="-1"></a><span class="st">    y = R::rbeta(x + a, n - x + b);</span></span>
<span id="cb181-22"><a href="#cb181-22" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb181-23"><a href="#cb181-23" tabindex="-1"></a><span class="st">    // 保存采样结果</span></span>
<span id="cb181-24"><a href="#cb181-24" tabindex="-1"></a><span class="st">    x_samples[i] = x;</span></span>
<span id="cb181-25"><a href="#cb181-25" tabindex="-1"></a><span class="st">    y_samples[i] = y;</span></span>
<span id="cb181-26"><a href="#cb181-26" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb181-27"><a href="#cb181-27" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb181-28"><a href="#cb181-28" tabindex="-1"></a><span class="st">  return List::create(</span></span>
<span id="cb181-29"><a href="#cb181-29" tabindex="-1"></a><span class="st">    Named(&quot;x_samples&quot;) = x_samples,</span></span>
<span id="cb181-30"><a href="#cb181-30" tabindex="-1"></a><span class="st">    Named(&quot;y_samples&quot;) = y_samples</span></span>
<span id="cb181-31"><a href="#cb181-31" tabindex="-1"></a><span class="st">  );</span></span>
<span id="cb181-32"><a href="#cb181-32" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb181-33"><a href="#cb181-33" tabindex="-1"></a><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: No function found for Rcpp::export attribute at file51c8548a4129.cpp:5</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" tabindex="-1"></a><span class="co"># 运行示例</span></span>
<span id="cb183-2"><a href="#cb183-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb183-3"><a href="#cb183-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb183-4"><a href="#cb183-4" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb183-5"><a href="#cb183-5" tabindex="-1"></a>num_iter <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb183-6"><a href="#cb183-6" tabindex="-1"></a>y_init <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb183-7"><a href="#cb183-7" tabindex="-1"></a></span>
<span id="cb183-8"><a href="#cb183-8" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n, a, b, num_iter, y_init)</span>
<span id="cb183-9"><a href="#cb183-9" tabindex="-1"></a></span>
<span id="cb183-10"><a href="#cb183-10" tabindex="-1"></a><span class="co"># 提取采样结果</span></span>
<span id="cb183-11"><a href="#cb183-11" tabindex="-1"></a>x_samples <span class="ot">&lt;-</span> result<span class="sc">$</span>x_samples</span>
<span id="cb183-12"><a href="#cb183-12" tabindex="-1"></a>y_samples <span class="ot">&lt;-</span> result<span class="sc">$</span>y_samples</span>
<span id="cb183-13"><a href="#cb183-13" tabindex="-1"></a></span>
<span id="cb183-14"><a href="#cb183-14" tabindex="-1"></a><span class="co"># 绘制采样轨迹</span></span>
<span id="cb183-15"><a href="#cb183-15" tabindex="-1"></a><span class="fu">plot</span>(x_samples, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">main =</span> <span class="st">&quot;X 的采样轨迹&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" tabindex="-1"></a><span class="fu">plot</span>(y_samples, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Y 的采样轨迹&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>2</strong> Compare the corresponding generated random numbers
with those by the R function you wrote using the function “qqplot”.</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" tabindex="-1"></a>gibbs_sampler_r <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, num_iter, y_init) {</span>
<span id="cb185-2"><a href="#cb185-2" tabindex="-1"></a>  x_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iter)</span>
<span id="cb185-3"><a href="#cb185-3" tabindex="-1"></a>  y_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iter)</span>
<span id="cb185-4"><a href="#cb185-4" tabindex="-1"></a>  </span>
<span id="cb185-5"><a href="#cb185-5" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y_init</span>
<span id="cb185-6"><a href="#cb185-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_iter) {</span>
<span id="cb185-7"><a href="#cb185-7" tabindex="-1"></a>    <span class="co"># 从 Binomial(n, y) 中采样 x | y</span></span>
<span id="cb185-8"><a href="#cb185-8" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb185-9"><a href="#cb185-9" tabindex="-1"></a>    <span class="co"># 从 Beta(x + a, n - x + b) 中采样 y | x</span></span>
<span id="cb185-10"><a href="#cb185-10" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb185-11"><a href="#cb185-11" tabindex="-1"></a>    </span>
<span id="cb185-12"><a href="#cb185-12" tabindex="-1"></a>    x_samples[i] <span class="ot">&lt;-</span> x</span>
<span id="cb185-13"><a href="#cb185-13" tabindex="-1"></a>    y_samples[i] <span class="ot">&lt;-</span> y</span>
<span id="cb185-14"><a href="#cb185-14" tabindex="-1"></a>  }</span>
<span id="cb185-15"><a href="#cb185-15" tabindex="-1"></a>  </span>
<span id="cb185-16"><a href="#cb185-16" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">x_samples =</span> x_samples, <span class="at">y_samples =</span> y_samples)</span>
<span id="cb185-17"><a href="#cb185-17" tabindex="-1"></a>}</span>
<span id="cb185-18"><a href="#cb185-18" tabindex="-1"></a></span>
<span id="cb185-19"><a href="#cb185-19" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb185-20"><a href="#cb185-20" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1212</span>)  <span class="co"># 确保可重复性</span></span>
<span id="cb185-21"><a href="#cb185-21" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb185-22"><a href="#cb185-22" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb185-23"><a href="#cb185-23" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb185-24"><a href="#cb185-24" tabindex="-1"></a>num_iter <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb185-25"><a href="#cb185-25" tabindex="-1"></a>y_init <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb185-26"><a href="#cb185-26" tabindex="-1"></a></span>
<span id="cb185-27"><a href="#cb185-27" tabindex="-1"></a><span class="co"># 调用 C++ 实现的采样器</span></span>
<span id="cb185-28"><a href="#cb185-28" tabindex="-1"></a>cpp_result <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n, a, b, num_iter, y_init)</span>
<span id="cb185-29"><a href="#cb185-29" tabindex="-1"></a>cpp_x_samples <span class="ot">&lt;-</span> cpp_result<span class="sc">$</span>x_samples</span>
<span id="cb185-30"><a href="#cb185-30" tabindex="-1"></a>cpp_y_samples <span class="ot">&lt;-</span> cpp_result<span class="sc">$</span>y_samples</span>
<span id="cb185-31"><a href="#cb185-31" tabindex="-1"></a></span>
<span id="cb185-32"><a href="#cb185-32" tabindex="-1"></a><span class="co"># 调用 R 实现的采样器</span></span>
<span id="cb185-33"><a href="#cb185-33" tabindex="-1"></a>r_result <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler_r</span>(n, a, b, num_iter, y_init)</span>
<span id="cb185-34"><a href="#cb185-34" tabindex="-1"></a>r_x_samples <span class="ot">&lt;-</span> r_result<span class="sc">$</span>x_samples</span>
<span id="cb185-35"><a href="#cb185-35" tabindex="-1"></a>r_y_samples <span class="ot">&lt;-</span> r_result<span class="sc">$</span>y_samples</span>
<span id="cb185-36"><a href="#cb185-36" tabindex="-1"></a></span>
<span id="cb185-37"><a href="#cb185-37" tabindex="-1"></a><span class="co"># 比较 x_samples</span></span>
<span id="cb185-38"><a href="#cb185-38" tabindex="-1"></a><span class="fu">qqplot</span>(r_x_samples, cpp_x_samples, <span class="at">main =</span> <span class="st">&quot;QQ Plot of x_samples (R vs C++)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;R Samples&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;C++ Samples&quot;</span>)</span>
<span id="cb185-39"><a href="#cb185-39" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" tabindex="-1"></a><span class="co"># 比较 y_samples</span></span>
<span id="cb186-2"><a href="#cb186-2" tabindex="-1"></a><span class="fu">qqplot</span>(r_y_samples, cpp_y_samples, <span class="at">main =</span> <span class="st">&quot;QQ Plot of y_samples (R vs C++)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;R Samples&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;C++ Samples&quot;</span>)</span>
<span id="cb186-3"><a href="#cb186-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>3</strong> Campare the computation time of the two functions
with the function “microbenchmark”.</p>
<p><strong>R代码</strong></p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb187-2"><a href="#cb187-2" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" tabindex="-1"></a><span class="co"># 使用 microbenchmark 比较计算时间</span></span>
<span id="cb189-2"><a href="#cb189-2" tabindex="-1"></a>benchmark_result <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb189-3"><a href="#cb189-3" tabindex="-1"></a>  <span class="at">Cpp =</span> <span class="fu">gibbs_sampler</span>(n, a, b, num_iter, y_init),</span>
<span id="cb189-4"><a href="#cb189-4" tabindex="-1"></a>  <span class="at">R =</span> <span class="fu">gibbs_sampler_r</span>(n, a, b, num_iter, y_init),</span>
<span id="cb189-5"><a href="#cb189-5" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">10</span></span>
<span id="cb189-6"><a href="#cb189-6" tabindex="-1"></a>)</span>
<span id="cb189-7"><a href="#cb189-7" tabindex="-1"></a></span>
<span id="cb189-8"><a href="#cb189-8" tabindex="-1"></a></span>
<span id="cb189-9"><a href="#cb189-9" tabindex="-1"></a><span class="co"># 显示运行时间结果</span></span>
<span id="cb189-10"><a href="#cb189-10" tabindex="-1"></a><span class="fu">print</span>(benchmark_result)</span></code></pre></div>
<pre><code>## Unit: microseconds
##  expr    min     lq    mean median     uq    max neval cld
##   Cpp  224.9  226.3  232.48  233.7  236.6  242.8    10  a 
##     R 2149.6 2162.0 2357.32 2180.4 2276.8 3340.7    10   b</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" tabindex="-1"></a><span class="co"># 绘制时间比较图</span></span>
<span id="cb191-2"><a href="#cb191-2" tabindex="-1"></a><span class="fu">boxplot</span>(benchmark_result, <span class="at">main =</span> <span class="st">&quot;Gibbs Sampler Performance (C++ vs R)&quot;</span>, </span>
<span id="cb191-3"><a href="#cb191-3" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Execution Time (ms)&quot;</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;lightgreen&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>4</strong> Comments your results.</p>
<p><strong>答</strong>
从输出结果（QQ图）来看，C++和R的运行结果差不多；从运行时间来看，C++几乎比R快十倍，运行时间显著地低于R实现，这是因为C++是编译型语言，运行时直接执行底层机器指令，而R是解释型语言，循环中的操作需要逐行解析和执行，效率较低；另外，从箱型图可以看出，C++实现的采样器运行时间短，而且比较稳定，时间波动更小。说明对于高迭代次数或需要高性能的采样任务，使用
C++ 实现可以显著提高效率。</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
